<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="ps__lattice_8c" kind="file">
    <compoundname>ps_lattice.c</compoundname>
    <includes local="no">assert.h</includes>
    <includes local="no">string.h</includes>
    <includes local="no">math.h</includes>
    <includes local="no">sphinxbase/ckd_alloc.h</includes>
    <includes local="no">sphinxbase/listelem_alloc.h</includes>
    <includes local="no">sphinxbase/strfuncs.h</includes>
    <includes local="no">sphinxbase/err.h</includes>
    <includes local="no">sphinxbase/pio.h</includes>
    <includes refid="pocketsphinx__internal_8h" local="yes">pocketsphinx_internal.h</includes>
    <includes refid="ps__lattice__internal_8h" local="yes">ps_lattice_internal.h</includes>
    <includes refid="ngram__search_8h" local="yes">ngram_search.h</includes>
    <includes refid="dict_8h" local="yes">dict.h</includes>
    <incdepgraph>
      <node id="1757">
        <label>sphinxbase/ngram_model.h</label>
      </node>
      <node id="1751">
        <label>sphinxbase/hash_table.h</label>
      </node>
      <node id="1768">
        <label>tmat.h</label>
        <link refid="tmat_8h"/>
        <childnode refid="1755" relation="include">
        </childnode>
        <childnode refid="1752" relation="include">
        </childnode>
      </node>
      <node id="1754">
        <label>pocketsphinx.h</label>
        <link refid="pocketsphinx_8h"/>
        <childnode refid="1755" relation="include">
        </childnode>
        <childnode refid="1748" relation="include">
        </childnode>
        <childnode refid="1752" relation="include">
        </childnode>
        <childnode refid="1749" relation="include">
        </childnode>
        <childnode refid="1750" relation="include">
        </childnode>
        <childnode refid="1756" relation="include">
        </childnode>
        <childnode refid="1757" relation="include">
        </childnode>
        <childnode refid="1751" relation="include">
        </childnode>
        <childnode refid="1758" relation="include">
        </childnode>
        <childnode refid="1759" relation="include">
        </childnode>
        <childnode refid="1760" relation="include">
        </childnode>
        <childnode refid="1762" relation="include">
        </childnode>
      </node>
      <node id="1739">
        <label>assert.h</label>
      </node>
      <node id="1773">
        <label>float.h</label>
      </node>
      <node id="1748">
        <label>sphinxbase/cmd_ln.h</label>
      </node>
      <node id="1772">
        <label>s3types.h</label>
        <link refid="s3types_8h"/>
        <childnode refid="1773" relation="include">
        </childnode>
        <childnode refid="1739" relation="include">
        </childnode>
        <childnode refid="1761" relation="include">
        </childnode>
        <childnode refid="1745" relation="include">
        </childnode>
        <childnode refid="1742" relation="include">
        </childnode>
      </node>
      <node id="1749">
        <label>sphinxbase/fe.h</label>
      </node>
      <node id="1770">
        <label>sphinxbase/fixpoint.h</label>
      </node>
      <node id="1767">
        <label>mdef.h</label>
        <link refid="mdef_8h"/>
        <childnode refid="1755" relation="include">
        </childnode>
        <childnode refid="1751" relation="include">
        </childnode>
      </node>
      <node id="1747">
        <label>pocketsphinx_internal.h</label>
        <link refid="pocketsphinx__internal_8h"/>
        <childnode refid="1748" relation="include">
        </childnode>
        <childnode refid="1749" relation="include">
        </childnode>
        <childnode refid="1750" relation="include">
        </childnode>
        <childnode refid="1751" relation="include">
        </childnode>
        <childnode refid="1752" relation="include">
        </childnode>
        <childnode refid="1753" relation="include">
        </childnode>
        <childnode refid="1754" relation="include">
        </childnode>
        <childnode refid="1763" relation="include">
        </childnode>
        <childnode refid="1771" relation="include">
        </childnode>
        <childnode refid="1774" relation="include">
        </childnode>
      </node>
      <node id="1762">
        <label>ps_mllr.h</label>
        <link refid="ps__mllr_8h"/>
        <childnode refid="1761" relation="include">
        </childnode>
        <childnode refid="1757" relation="include">
        </childnode>
        <childnode refid="1758" relation="include">
        </childnode>
      </node>
      <node id="1766">
        <label>sphinxbase/mmio.h</label>
      </node>
      <node id="1742">
        <label>sphinxbase/ckd_alloc.h</label>
      </node>
      <node id="1743">
        <label>sphinxbase/listelem_alloc.h</label>
      </node>
      <node id="1746">
        <label>sphinxbase/pio.h</label>
      </node>
      <node id="1758">
        <label>pocketsphinx_export.h</label>
        <link refid="pocketsphinx__export_8h_source"/>
      </node>
      <node id="1750">
        <label>sphinxbase/feat.h</label>
      </node>
      <node id="1740">
        <label>string.h</label>
      </node>
      <node id="1761">
        <label>sphinxbase/prim_type.h</label>
      </node>
      <node id="1764">
        <label>sphinxbase/bitvec.h</label>
      </node>
      <node id="1769">
        <label>hmm.h</label>
        <link refid="hmm_8h"/>
        <childnode refid="1755" relation="include">
        </childnode>
        <childnode refid="1770" relation="include">
        </childnode>
        <childnode refid="1743" relation="include">
        </childnode>
        <childnode refid="1765" relation="include">
        </childnode>
      </node>
      <node id="1738">
        <label>src/libpocketsphinx/ps_lattice.c</label>
        <link refid="ps_lattice.c"/>
        <childnode refid="1739" relation="include">
        </childnode>
        <childnode refid="1740" relation="include">
        </childnode>
        <childnode refid="1741" relation="include">
        </childnode>
        <childnode refid="1742" relation="include">
        </childnode>
        <childnode refid="1743" relation="include">
        </childnode>
        <childnode refid="1744" relation="include">
        </childnode>
        <childnode refid="1745" relation="include">
        </childnode>
        <childnode refid="1746" relation="include">
        </childnode>
        <childnode refid="1747" relation="include">
        </childnode>
        <childnode refid="1775" relation="include">
        </childnode>
        <childnode refid="1776" relation="include">
        </childnode>
        <childnode refid="1771" relation="include">
        </childnode>
      </node>
      <node id="1763">
        <label>acmod.h</label>
        <link refid="acmod_8h"/>
        <childnode refid="1755" relation="include">
        </childnode>
        <childnode refid="1748" relation="include">
        </childnode>
        <childnode refid="1752" relation="include">
        </childnode>
        <childnode refid="1749" relation="include">
        </childnode>
        <childnode refid="1750" relation="include">
        </childnode>
        <childnode refid="1764" relation="include">
        </childnode>
        <childnode refid="1745" relation="include">
        </childnode>
        <childnode refid="1761" relation="include">
        </childnode>
        <childnode refid="1762" relation="include">
        </childnode>
        <childnode refid="1765" relation="include">
        </childnode>
        <childnode refid="1768" relation="include">
        </childnode>
        <childnode refid="1769" relation="include">
        </childnode>
      </node>
      <node id="1760">
        <label>ps_lattice.h</label>
        <link refid="ps__lattice_8h"/>
        <childnode refid="1761" relation="include">
        </childnode>
        <childnode refid="1757" relation="include">
        </childnode>
        <childnode refid="1758" relation="include">
        </childnode>
      </node>
      <node id="1776">
        <label>ngram_search.h</label>
        <link refid="ngram__search_8h"/>
        <childnode refid="1748" relation="include">
        </childnode>
        <childnode refid="1752" relation="include">
        </childnode>
        <childnode refid="1757" relation="include">
        </childnode>
        <childnode refid="1743" relation="include">
        </childnode>
        <childnode refid="1745" relation="include">
        </childnode>
        <childnode refid="1747" relation="include">
        </childnode>
        <childnode refid="1769" relation="include">
        </childnode>
      </node>
      <node id="1765">
        <label>bin_mdef.h</label>
        <link refid="bin__mdef_8h"/>
        <childnode refid="1766" relation="include">
        </childnode>
        <childnode refid="1748" relation="include">
        </childnode>
        <childnode refid="1758" relation="include">
        </childnode>
        <childnode refid="1767" relation="include">
        </childnode>
      </node>
      <node id="1744">
        <label>sphinxbase/strfuncs.h</label>
      </node>
      <node id="1759">
        <label>cmdln_macro.h</label>
        <link refid="cmdln__macro_8h_source"/>
        <childnode refid="1748" relation="include">
        </childnode>
        <childnode refid="1750" relation="include">
        </childnode>
        <childnode refid="1749" relation="include">
        </childnode>
      </node>
      <node id="1741">
        <label>math.h</label>
      </node>
      <node id="1745">
        <label>sphinxbase/err.h</label>
      </node>
      <node id="1775">
        <label>ps_lattice_internal.h</label>
        <link refid="ps__lattice__internal_8h"/>
      </node>
      <node id="1771">
        <label>dict.h</label>
        <link refid="dict_8h"/>
        <childnode refid="1751" relation="include">
        </childnode>
        <childnode refid="1772" relation="include">
        </childnode>
        <childnode refid="1765" relation="include">
        </childnode>
        <childnode refid="1758" relation="include">
        </childnode>
      </node>
      <node id="1774">
        <label>dict2pid.h</label>
        <link refid="dict2pid_8h"/>
        <childnode refid="1755" relation="include">
        </childnode>
        <childnode refid="1752" relation="include">
        </childnode>
        <childnode refid="1764" relation="include">
        </childnode>
        <childnode refid="1772" relation="include">
        </childnode>
        <childnode refid="1765" relation="include">
        </childnode>
        <childnode refid="1771" relation="include">
        </childnode>
      </node>
      <node id="1756">
        <label>sphinxbase/fsg_model.h</label>
      </node>
      <node id="1752">
        <label>sphinxbase/logmath.h</label>
      </node>
      <node id="1753">
        <label>sphinxbase/profile.h</label>
      </node>
      <node id="1755">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="ps__lattice_8c_1a9c568a0d36c2d1416f593928a24d93f2" prot="public" static="no">
        <name>MAX_PATHS</name>
        <initializer>500     /* Max allowed active paths at any time */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1522" column="9" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1522" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="ps__lattice_8c_1a42679d6e9a4ea05961867c999a22772b" prot="public" static="no">
        <name>MAX_HYP_TRIES</name>
        <initializer>10000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1523" column="9" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1523" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="ps__lattice_8c_1a4bbf6454184dc83bcc2bdec517431cb0" prot="public" static="yes" mutable="no">
        <type><ref refid="structps__segfuncs__s" kindref="compound">ps_segfuncs_t</ref></type>
        <definition>ps_segfuncs_t ps_lattice_segfuncs</definition>
        <argsstring></argsstring>
        <name>ps_lattice_segfuncs</name>
        <initializer>= {
     ps_lattice_seg_next,
     ps_lattice_seg_free
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1023" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1023" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="ps__lattice_8c_1a33551df4ef41037f6f74160c79f89531" prot="public" static="yes" mutable="no">
        <type><ref refid="structps__segfuncs__s" kindref="compound">ps_segfuncs_t</ref></type>
        <definition>ps_segfuncs_t ps_astar_segfuncs</definition>
        <argsstring></argsstring>
        <name>ps_astar_segfuncs</name>
        <initializer>= {
     ps_astar_seg_next,
     ps_astar_seg_free
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1845" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1845" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_lattice_link</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *from, ps_latnode_t *to, int32 score, int32 ef)</argsstring>
        <name>ps_lattice_link</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>from</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>to</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>score</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>ef</declname>
        </param>
        <briefdescription>
<para>Create a directed link between &quot;from&quot; and &quot;to&quot; nodes, but if a link already exists, choose one with the best link_scr. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="65" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="65" bodyend="103"/>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <references refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" compoundref="ps__lattice__internal_8h" startline="81">ps_lattice_s::latlink_alloc</references>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" compoundref="ps__lattice__internal_8h" startline="102">ps_latlink_s::ef</references>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" compoundref="hmm_8h" startline="99">BETTER_THAN</references>
        <referencedby refid="ngram__search_8h_1ac30e7dec4bbfeee9f5163abf4bbd1014" compoundref="ngram__search_8c" startline="1217" endline="1404">ngram_search_lattice</referencedby>
        <referencedby refid="ps__lattice__internal_8h_1a9b40adaa059978fe33959d59da1b6919" compoundref="ps__lattice_8c" startline="106" endline="140">ps_lattice_bypass_fillers</referencedby>
        <referencedby refid="ps__lattice_8c_1aaf4a101f324943c7635746ec6ba7ab06" compoundref="ps__lattice_8c" startline="410" endline="653">ps_lattice_read</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a9b40adaa059978fe33959d59da1b6919" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_lattice_bypass_fillers</definition>
        <argsstring>(ps_lattice_t *dag, int32 silpen, int32 fillpen)</argsstring>
        <name>ps_lattice_bypass_fillers</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>silpen</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>fillpen</declname>
        </param>
        <briefdescription>
<para>Bypass filler words. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="106" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="106" bodyend="140"/>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" compoundref="dict_8c" startline="397" endline="408">dict_filler_word</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="structps__lattice__s_1acd3f3ab2649f649ba33bf2a422cf12b8" compoundref="ps__lattice__internal_8h" startline="67">ps_lattice_s::silence</references>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" compoundref="ps__lattice_8c" startline="65" endline="103">ps_lattice_link</references>
        <references refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" compoundref="ps__lattice__internal_8h" startline="102">ps_latlink_s::ef</references>
        <references refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" compoundref="ps__lattice__internal_8h" startline="121">ps_latnode_s::reachable</references>
        <referencedby refid="ngram__search_8h_1ac30e7dec4bbfeee9f5163abf4bbd1014" compoundref="ngram__search_8c" startline="1217" endline="1404">ngram_search_lattice</referencedby>
        <referencedby refid="ps__lattice_8c_1aaf4a101f324943c7635746ec6ba7ab06" compoundref="ps__lattice_8c" startline="410" endline="653">ps_lattice_read</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a7d57145999a5ca03aa2ee60c00fd0944" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void delete_node</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *node)</argsstring>
        <name>delete_node</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="143" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="143" bodyend="158"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a82c45a1fd995452dad7d2ce4ecfa96df" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void remove_dangling_links</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *node)</argsstring>
        <name>remove_dangling_links</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="162" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="162" bodyend="194"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a6da4e36322aaab4d2ebe812bee9a4439" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_lattice_delete_unreachable</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_delete_unreachable</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Remove nodes marked as unreachable. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="197" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="197" bodyend="230"/>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" compoundref="ps__lattice__internal_8h" startline="121">ps_latnode_s::reachable</references>
        <references refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" compoundref="ps__lattice__internal_8h" startline="114">ps_latnode_s::id</references>
        <referencedby refid="ngram__search_8h_1ac30e7dec4bbfeee9f5163abf4bbd1014" compoundref="ngram__search_8c" startline="1217" endline="1404">ngram_search_lattice</referencedby>
        <referencedby refid="ps__lattice_8c_1aaf4a101f324943c7635746ec6ba7ab06" compoundref="ps__lattice_8c" startline="410" endline="653">ps_lattice_read</referencedby>
        <referencedby refid="ps__lattice_8c_1a54c24dc8436c39d0ccc044f7b0ef8f3a" compoundref="ps__lattice_8c" startline="1477" endline="1518">ps_lattice_posterior_prune</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a520b99eff2c1dba89927f0f3d258b8aa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 ps_lattice_write</definition>
        <argsstring>(ps_lattice_t *dag, char const *filename)</argsstring>
        <name>ps_lattice_write</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>char const *</type>
          <declname>filename</declname>
        </param>
        <briefdescription>
<para>Write a lattice to disk. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>0 for success, &lt;0 on failure. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="233" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="233" bodyend="290"/>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" compoundref="hmm_8h" startline="99">BETTER_THAN</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" compoundref="ps__lattice__internal_8h" startline="118">ps_latnode_s::fef</references>
        <references refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" compoundref="ps__lattice__internal_8h" startline="114">ps_latnode_s::id</references>
        <references refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" compoundref="ps__lattice__internal_8h" startline="119">ps_latnode_s::lef</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" compoundref="ps__lattice__internal_8h" startline="74">ps_lattice_s::n_frames</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__latnode__s_1a50d14c033652a4fb387f76881df1c3f6" compoundref="ps__lattice__internal_8h" startline="122">ps_latnode_s::node_id</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" compoundref="hmm_8h" startline="77">SENSCR_SHIFT</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <references refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" compoundref="ps__lattice__internal_8h" startline="115">ps_latnode_s::wid</references>
        <references refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" compoundref="hmm_8h" startline="104">WORSE_THAN</references>
        <references refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" compoundref="hmm_8h" startline="88">WORST_SCORE</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a1ac6d846fbecfcaba6094d84e93655f7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 ps_lattice_write_htk</definition>
        <argsstring>(ps_lattice_t *dag, char const *filename)</argsstring>
        <name>ps_lattice_write_htk</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>char const *</type>
          <declname>filename</declname>
        </param>
        <briefdescription>
<para>Write a lattice to disk in HTK format. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>0 for success, &lt;0 on failure. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="293" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="293" bodyend="370"/>
        <references refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" compoundref="ps__lattice__internal_8h" startline="103">ps_latlink_s::alpha</references>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" compoundref="ps__lattice__internal_8h" startline="104">ps_latlink_s::beta</references>
        <references refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" compoundref="hmm_8h" startline="99">BETTER_THAN</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" compoundref="dict_8c" startline="397" endline="408">dict_filler_word</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" compoundref="ps__lattice__internal_8h" startline="68">ps_lattice_s::frate</references>
        <references refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" compoundref="ps__lattice__internal_8h" startline="114">ps_latnode_s::id</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
        <references refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" compoundref="ps__lattice__internal_8h" startline="121">ps_latnode_s::reachable</references>
        <references refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" compoundref="hmm_8h" startline="77">SENSCR_SHIFT</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <references refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" compoundref="ps__lattice__internal_8h" startline="115">ps_latnode_s::wid</references>
        <references refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" compoundref="hmm_8h" startline="104">WORSE_THAN</references>
        <references refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" compoundref="hmm_8h" startline="88">WORST_SCORE</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a0686f50b446688c473023c2c42582b5e" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int dag_param_read</definition>
        <argsstring>(lineiter_t *li, char *param)</argsstring>
        <name>dag_param_read</name>
        <param>
          <type>lineiter_t *</type>
          <declname>li</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>param</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="374" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="374" bodyend="395"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ab5eff9dea48695e19547d6bb57331e21" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void dag_mark_reachable</definition>
        <argsstring>(ps_latnode_t *d)</argsstring>
        <name>dag_mark_reachable</name>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>d</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="399" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="399" bodyend="407"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1aaf4a101f324943c7635746ec6ba7ab06" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
        <definition>ps_lattice_t* ps_lattice_read</definition>
        <argsstring>(ps_decoder_t *ps, char const *file)</argsstring>
        <name>ps_lattice_read</name>
        <param>
          <type>struct <ref refid="structps__decoder__s" kindref="compound">ps_decoder_s</ref> *</type>
          <declname>ps</declname>
        </param>
        <param>
          <type>char const *</type>
          <declname>file</declname>
        </param>
        <briefdescription>
<para>Read a lattice from a file on disk. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ps</parametername>
</parameternamelist>
<parameterdescription>
<para>Decoder to use for processing this lattice, or NULL. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>file</parametername>
</parameternamelist>
<parameterdescription>
<para>Path to lattice file. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Newly created lattice, or NULL for failure. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="410" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="410" bodyend="653"/>
        <references refid="s3types_8h_1a5c42410b7125da611210c5a4be29898b" compoundref="s3types_8h" startline="136">BAD_S3WID</references>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__search__s_1aa6e3e18165bbc70084a06575d5703042" compoundref="pocketsphinx__internal_8h" startline="109">ps_search_s::config</references>
        <references refid="structps__decoder__s_1a0565ed97b32408bd05c8104f020cef05" compoundref="pocketsphinx__internal_8h" startline="204">ps_decoder_s::config</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__decoder__s_1aef6228c17907cc1d0cef835b238b5d91" compoundref="pocketsphinx__internal_8h" startline="209">ps_decoder_s::dict</references>
        <references refid="dict_8h_1a24888ac8e24259e553c43c4655b38432" compoundref="dict_8c" startline="80" endline="145">dict_add_word</references>
        <references refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" compoundref="dict_8c" startline="397" endline="408">dict_filler_word</references>
        <references refid="dict_8h_1a05d8dac3e5fe5399ccb8bf7776e203e2" compoundref="dict_8c" startline="252" endline="379">dict_init</references>
        <references refid="dict_8h_1a0edf70be186e8940af9d21243083cb8b" compoundref="dict_8c" startline="445" endline="449">dict_retain</references>
        <references refid="dict_8h_1a3a128531ae9c077be9882119ed05fe3a" compoundref="dict_8c" startline="426" endline="442">dict_word2basestr</references>
        <references refid="dict_8h_1ad3729eb1a02a9a321e17933f7e90c80e" compoundref="dict_8c" startline="383" endline="393">dict_wordid</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" compoundref="ps__lattice__internal_8h" startline="118">ps_latnode_s::fef</references>
        <references refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" compoundref="ps__lattice__internal_8h" startline="68">ps_lattice_s::frate</references>
        <references refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" compoundref="ps__lattice__internal_8h" startline="114">ps_latnode_s::id</references>
        <references refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" compoundref="ps__lattice__internal_8h" startline="81">ps_lattice_s::latlink_alloc</references>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <references refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" compoundref="ps__lattice__internal_8h" startline="80">ps_lattice_s::latnode_alloc</references>
        <references refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" compoundref="ps__lattice__internal_8h" startline="119">ps_latnode_s::lef</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__decoder__s_1abd17fe329f2fb219c5a534f3217c5b95" compoundref="pocketsphinx__internal_8h" startline="211">ps_decoder_s::lmath</references>
        <references refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" compoundref="ps__lattice__internal_8h" startline="74">ps_lattice_s::n_frames</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="ps__lattice_8c_1a9b40adaa059978fe33959d59da1b6919" compoundref="ps__lattice_8c" startline="106" endline="140">ps_lattice_bypass_fillers</references>
        <references refid="ps__lattice_8c_1a6da4e36322aaab4d2ebe812bee9a4439" compoundref="ps__lattice_8c" startline="197" endline="230">ps_lattice_delete_unreachable</references>
        <references refid="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" compoundref="ps__lattice_8c" startline="65" endline="103">ps_lattice_link</references>
        <references refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" compoundref="ps__lattice__internal_8h" startline="121">ps_latnode_s::reachable</references>
        <references refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" compoundref="ps__lattice__internal_8h" startline="62">ps_lattice_s::refcount</references>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="structps__decoder__s_1ad337270efc93613cf8dd7594f6515799" compoundref="pocketsphinx__internal_8h" startline="217">ps_decoder_s::search</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
        <references refid="structps__lattice__s_1acd3f3ab2649f649ba33bf2a422cf12b8" compoundref="ps__lattice__internal_8h" startline="67">ps_lattice_s::silence</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" compoundref="ps__lattice__internal_8h" startline="115">ps_latnode_s::wid</references>
        <references refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" compoundref="hmm_8h" startline="104">WORSE_THAN</references>
        <references refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" compoundref="hmm_8h" startline="88">WORST_SCORE</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a60b5a6a96a68e9b778dbef2156d859c8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ps_lattice_n_frames</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_n_frames</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Get the number of frames in the lattice. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>The lattice in question. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Number of frames in this lattice. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="656" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="656" bodyend="659"/>
        <references refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" compoundref="ps__lattice__internal_8h" startline="74">ps_lattice_s::n_frames</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a606f6ee0fd569dd5829d7f84ae7e61bd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
        <definition>ps_lattice_t* ps_lattice_init_search</definition>
        <argsstring>(ps_search_t *search, int n_frame)</argsstring>
        <name>ps_lattice_init_search</name>
        <param>
          <type><ref refid="pocketsphinx__internal_8h_1adc3de4d62e46c5e6cb93d09fb61be8ee" kindref="member">ps_search_t</ref> *</type>
          <declname>search</declname>
        </param>
        <param>
          <type>int</type>
          <declname>n_frame</declname>
        </param>
        <briefdescription>
<para>Construct an empty word graph with reference to a search structure. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="662" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="662" bodyend="678"/>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="dict_8h_1a0edf70be186e8940af9d21243083cb8b" compoundref="dict_8c" startline="445" endline="449">dict_retain</references>
        <references refid="structps__search__s_1a918f243fa966e72c47f697fb9e60089d" compoundref="pocketsphinx__internal_8h" startline="111">ps_search_s::dict</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__search__s_1a0fdf6fe8c4d9c28f10c48c09517c6b91" compoundref="pocketsphinx__internal_8h" startline="110">ps_search_s::acmod</references>
        <references refid="structacmod__s_1a9de7e8ac9c0c4df3d2a9ad5406787f3c" compoundref="acmod_8h" startline="151">acmod_s::lmath</references>
        <references refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" compoundref="ps__lattice__internal_8h" startline="68">ps_lattice_s::frate</references>
        <references refid="structps__search__s_1aa6e3e18165bbc70084a06575d5703042" compoundref="pocketsphinx__internal_8h" startline="109">ps_search_s::config</references>
        <references refid="structps__lattice__s_1acd3f3ab2649f649ba33bf2a422cf12b8" compoundref="ps__lattice__internal_8h" startline="67">ps_lattice_s::silence</references>
        <references refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" compoundref="ps__lattice__internal_8h" startline="74">ps_lattice_s::n_frames</references>
        <references refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" compoundref="ps__lattice__internal_8h" startline="80">ps_lattice_s::latnode_alloc</references>
        <references refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" compoundref="ps__lattice__internal_8h" startline="81">ps_lattice_s::latlink_alloc</references>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <references refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" compoundref="ps__lattice__internal_8h" startline="62">ps_lattice_s::refcount</references>
        <referencedby refid="ngram__search_8h_1ac30e7dec4bbfeee9f5163abf4bbd1014" compoundref="ngram__search_8c" startline="1217" endline="1404">ngram_search_lattice</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1af8a33c587f5b7a6f5b8c86e6068dc297" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
        <definition>ps_lattice_t* ps_lattice_retain</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_retain</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Retain a lattice. </para>        </briefdescription>
        <detaileddescription>
<para>This function retains ownership of a lattice for the caller, preventing it from being freed automatically. You must call <ref refid="ps__lattice_8h_1a3f90e846bde47cd1acdff165b92f5c22" kindref="member">ps_lattice_free()</ref> to free it after having called this function.</para><para><simplesect kind="return"><para>pointer to the retained lattice. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="681" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="681" bodyend="685"/>
        <references refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" compoundref="ps__lattice__internal_8h" startline="62">ps_lattice_s::refcount</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1aed9371a246b6565a2142c3baefd08002" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ps_lattice_free</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_free</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Free a lattice. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>new reference count (0 if dag was freed) </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="688" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="688" bodyend="702"/>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="dict_8h_1a51ee6c067decce8dbc182f95f7b33e91" compoundref="dict_8c" startline="452" endline="480">dict_free</references>
        <references refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" compoundref="ps__lattice__internal_8h" startline="78">ps_lattice_s::hyp_str</references>
        <references refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" compoundref="ps__lattice__internal_8h" startline="81">ps_lattice_s::latlink_alloc</references>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <references refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" compoundref="ps__lattice__internal_8h" startline="80">ps_lattice_s::latnode_alloc</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" compoundref="ps__lattice__internal_8h" startline="62">ps_lattice_s::refcount</references>
        <referencedby refid="ngram__search_8h_1ac30e7dec4bbfeee9f5163abf4bbd1014" compoundref="ngram__search_8c" startline="1217" endline="1404">ngram_search_lattice</referencedby>
        <referencedby refid="pocketsphinx__internal_8h_1a1299496b3498166928702d0701934e50" compoundref="pocketsphinx_8c" startline="1310" endline="1318">ps_search_deinit</referencedby>
        <referencedby refid="pocketsphinx_8h_1a0b70e54570e21ad3a784b40071818579" compoundref="pocketsphinx_8c" startline="811" endline="891">ps_start_utt</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a4a952a1cb88b833989fb39476da5fe1b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>logmath_t *</type>
        <definition>logmath_t* ps_lattice_get_logmath</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_get_logmath</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Get the log-math computation object for this lattice. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>The log-math object for this lattice. The lattice retains ownership of this pointer, so you should not attempt to free it manually. Use logmath_retain() if you wish to reuse it elsewhere. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="705" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="705" bodyend="708"/>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a607bfd65847baff33f404936c1543d16" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1afd06dd0a4f63e1b1912c1a53b6a75de6" kindref="member">ps_latnode_iter_t</ref> *</type>
        <definition>ps_latnode_iter_t* ps_latnode_iter</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_latnode_iter</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Start iterating over nodes in the lattice. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>No particular order of traversal is guaranteed, and you should not depend on this.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to iterate over. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Iterator over lattice nodes. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="711" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="711" bodyend="714"/>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a77c4bbb13e260c72ed04ad93b02fdf0e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1afd06dd0a4f63e1b1912c1a53b6a75de6" kindref="member">ps_latnode_iter_t</ref> *</type>
        <definition>ps_latnode_iter_t* ps_latnode_iter_next</definition>
        <argsstring>(ps_latnode_iter_t *itor)</argsstring>
        <name>ps_latnode_iter_next</name>
        <param>
          <type><ref refid="ps__lattice_8h_1afd06dd0a4f63e1b1912c1a53b6a75de6" kindref="member">ps_latnode_iter_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
<para>Move to next node in iteration. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>itor</parametername>
</parameternamelist>
<parameterdescription>
<para>Node iterator. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Updated node iterator, or NULL if finished </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="717" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="717" bodyend="720"/>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ae1d64649785989033826329b9fcce309" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_latnode_iter_free</definition>
        <argsstring>(ps_latnode_iter_t *itor)</argsstring>
        <name>ps_latnode_iter_free</name>
        <param>
          <type><ref refid="ps__lattice_8h_1afd06dd0a4f63e1b1912c1a53b6a75de6" kindref="member">ps_latnode_iter_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
<para>Stop iterating over nodes. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>itor</parametername>
</parameternamelist>
<parameterdescription>
<para>Node iterator. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="723" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="723" bodyend="726"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a990f488a747f95bc94777a755401710d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
        <definition>ps_latnode_t* ps_latnode_iter_node</definition>
        <argsstring>(ps_latnode_iter_t *itor)</argsstring>
        <name>ps_latnode_iter_node</name>
        <param>
          <type><ref refid="ps__lattice_8h_1afd06dd0a4f63e1b1912c1a53b6a75de6" kindref="member">ps_latnode_iter_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
<para>Get node from iterator. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="729" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="729" bodyend="732"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a89b67432447f693f787ec14460cfa2a4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ps_latnode_times</definition>
        <argsstring>(ps_latnode_t *node, int16 *out_fef, int16 *out_lef)</argsstring>
        <name>ps_latnode_times</name>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <param>
          <type>int16 *</type>
          <declname>out_fef</declname>
        </param>
        <param>
          <type>int16 *</type>
          <declname>out_lef</declname>
        </param>
        <briefdescription>
<para>Get start and end time range for a node. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>node</parametername>
</parameternamelist>
<parameterdescription>
<para>Node inquired about. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_fef</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: End frame of first exit from this node. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_lef</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: End frame of last exit from this node. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Start frame for all edges exiting this node. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="735" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="735" bodyend="740"/>
        <references refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" compoundref="ps__lattice__internal_8h" startline="118">ps_latnode_s::fef</references>
        <references refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" compoundref="ps__lattice__internal_8h" startline="119">ps_latnode_s::lef</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a5827c1004a64e7e6c5208928c28d403d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char const *</type>
        <definition>char const* ps_latnode_word</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *node)</argsstring>
        <name>ps_latnode_word</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <briefdescription>
<para>Get word string for this node. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to which node belongs. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>node</parametername>
</parameternamelist>
<parameterdescription>
<para>Node inquired about. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Word string for this node (possibly a pronunciation variant). </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="743" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="743" bodyend="746"/>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" compoundref="ps__lattice__internal_8h" startline="115">ps_latnode_s::wid</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a42212e56eb6e881a0ceb1b8ad029427a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char const *</type>
        <definition>char const* ps_latnode_baseword</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *node)</argsstring>
        <name>ps_latnode_baseword</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <briefdescription>
<para>Get base word string for this node. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to which node belongs. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>node</parametername>
</parameternamelist>
<parameterdescription>
<para>Node inquired about. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Base word string for this node. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="749" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="749" bodyend="752"/>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ad9c31352fa8e6286b1221221208075e9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 ps_latnode_prob</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *node, ps_latlink_t **out_link)</argsstring>
        <name>ps_latnode_prob</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> **</type>
          <declname>out_link</declname>
        </param>
        <briefdescription>
<para>Get best posterior probability and associated acoustic score from a lattice node. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to which node belongs. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>node</parametername>
</parameternamelist>
<parameterdescription>
<para>Node inquired about. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_link</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: exit link with highest posterior probability </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Posterior probability of the best link exiting this node. Log is expressed in the log-base used in the decoder. To convert to linear floating-point, use logmath_exp(ps_lattice_get_logmath(), pprob). </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="755" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="755" bodyend="769"/>
        <references refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" compoundref="ps__lattice__internal_8h" startline="103">ps_latlink_s::alpha</references>
        <references refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" compoundref="ps__lattice__internal_8h" startline="104">ps_latlink_s::beta</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a6169f8a8d8b7f84596438e5bb3095bc6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a3a6312ccf7e1697399822c47a99c4645" kindref="member">ps_latlink_iter_t</ref> *</type>
        <definition>ps_latlink_iter_t* ps_latnode_exits</definition>
        <argsstring>(ps_latnode_t *node)</argsstring>
        <name>ps_latnode_exits</name>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <briefdescription>
<para>Iterate over exits from this node. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>node</parametername>
</parameternamelist>
<parameterdescription>
<para>Node inquired about. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Iterator over exit links from this node. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="772" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="772" bodyend="775"/>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a36f3fa1635d251b908c553153f614e22" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a3a6312ccf7e1697399822c47a99c4645" kindref="member">ps_latlink_iter_t</ref> *</type>
        <definition>ps_latlink_iter_t* ps_latnode_entries</definition>
        <argsstring>(ps_latnode_t *node)</argsstring>
        <name>ps_latnode_entries</name>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>node</declname>
        </param>
        <briefdescription>
<para>Iterate over entries to this node. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>node</parametername>
</parameternamelist>
<parameterdescription>
<para>Node inquired about. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Iterator over entry links to this node. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="778" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="778" bodyend="781"/>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a6caee73548f9a6c17626e959256d721c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a3a6312ccf7e1697399822c47a99c4645" kindref="member">ps_latlink_iter_t</ref> *</type>
        <definition>ps_latlink_iter_t* ps_latlink_iter_next</definition>
        <argsstring>(ps_latlink_iter_t *itor)</argsstring>
        <name>ps_latlink_iter_next</name>
        <param>
          <type><ref refid="ps__lattice_8h_1a3a6312ccf7e1697399822c47a99c4645" kindref="member">ps_latlink_iter_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
<para>Get next link from a lattice link iterator. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>itor</parametername>
</parameternamelist>
<parameterdescription>
<para>Iterator. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Updated iterator, or NULL if finished. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="784" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="784" bodyend="787"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1aab5953eafb2e632307259a7fc40c01e3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_latlink_iter_free</definition>
        <argsstring>(ps_latlink_iter_t *itor)</argsstring>
        <name>ps_latlink_iter_free</name>
        <param>
          <type><ref refid="ps__lattice_8h_1a3a6312ccf7e1697399822c47a99c4645" kindref="member">ps_latlink_iter_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
<para>Stop iterating over links. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>itor</parametername>
</parameternamelist>
<parameterdescription>
<para>Link iterator. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="790" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="790" bodyend="793"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a33a6c95621d4c8980a8c6b0f8af3bc67" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_latlink_iter_link</definition>
        <argsstring>(ps_latlink_iter_t *itor)</argsstring>
        <name>ps_latlink_iter_link</name>
        <param>
          <type><ref refid="ps__lattice_8h_1a3a6312ccf7e1697399822c47a99c4645" kindref="member">ps_latlink_iter_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
<para>Get link from iterator. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="796" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="796" bodyend="799"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1afc4403b067467f3c74c97998f1c91886" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ps_latlink_times</definition>
        <argsstring>(ps_latlink_t *link, int16 *out_sf)</argsstring>
        <name>ps_latlink_times</name>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type>int16 *</type>
          <declname>out_sf</declname>
        </param>
        <briefdescription>
<para>Get start and end times from a lattice link. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>these are <bold>inclusive</bold> - i.e. the last frame of this word is ef, not ef-1.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>link</parametername>
</parameternamelist>
<parameterdescription>
<para>Link inquired about. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_sf</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: (optional) start frame of this link. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>End frame of this link. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="802" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="802" bodyend="813"/>
        <references refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" compoundref="ps__lattice__internal_8h" startline="102">ps_latlink_s::ef</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a891d9c5aa6a5cbe8631812fbd6e87e25" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
        <definition>ps_latnode_t* ps_latlink_nodes</definition>
        <argsstring>(ps_latlink_t *link, ps_latnode_t **out_src)</argsstring>
        <name>ps_latlink_nodes</name>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> **</type>
          <declname>out_src</declname>
        </param>
        <briefdescription>
<para>Get destination and source nodes from a lattice link. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>link</parametername>
</parameternamelist>
<parameterdescription>
<para>Link inquired about </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_src</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: (optional) source node. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>destination node </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="816" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="816" bodyend="820"/>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a3c765dfc290549e8f27e619269d20e5a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char const *</type>
        <definition>char const* ps_latlink_word</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link)</argsstring>
        <name>ps_latlink_word</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <briefdescription>
<para>Get word string from a lattice link. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to which node belongs. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>link</parametername>
</parameternamelist>
<parameterdescription>
<para>Link inquired about </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Word string for this link (possibly a pronunciation variant). </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="823" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="823" bodyend="828"/>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" compoundref="ps__lattice__internal_8h" startline="115">ps_latnode_s::wid</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a1f8f4dba5bbcf9056c5bd3e97e39839d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char const *</type>
        <definition>char const* ps_latlink_baseword</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link)</argsstring>
        <name>ps_latlink_baseword</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <briefdescription>
<para>Get base word string from a lattice link. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to which node belongs. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>link</parametername>
</parameternamelist>
<parameterdescription>
<para>Link inquired about </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Base word string for this link </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="831" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="831" bodyend="836"/>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a6ea04952718752806ad92773c98ac33d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_latlink_pred</definition>
        <argsstring>(ps_latlink_t *link)</argsstring>
        <name>ps_latlink_pred</name>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <briefdescription>
<para>Get predecessor link in best path. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>link</parametername>
</parameternamelist>
<parameterdescription>
<para>Link inquired about </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Best previous link from bestpath search, if any. Otherwise NULL </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="839" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="839" bodyend="842"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a7025b47d1224f01fef725ffdae71becc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 ps_latlink_prob</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link, int32 *out_ascr)</argsstring>
        <name>ps_latlink_prob</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>out_ascr</declname>
        </param>
        <briefdescription>
<para>Get acoustic score and posterior probability from a lattice link. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to which node belongs. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>link</parametername>
</parameternamelist>
<parameterdescription>
<para>Link inquired about </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>out_ascr</parametername>
</parameternamelist>
<parameterdescription>
<para>Output: (optional) acoustic score. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Posterior probability for this link. Log is expressed in the log-base used in the decoder. To convert to linear floating-point, use logmath_exp(ps_lattice_get_logmath(), pprob). </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="845" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="845" bodyend="850"/>
        <references refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" compoundref="ps__lattice__internal_8h" startline="103">ps_latlink_s::alpha</references>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" compoundref="ps__lattice__internal_8h" startline="104">ps_latlink_s::beta</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
        <references refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" compoundref="hmm_8h" startline="77">SENSCR_SHIFT</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a02b07c009d23b852bd4db54700dfac5b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char const *</type>
        <definition>char const* ps_lattice_hyp</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link)</argsstring>
        <name>ps_lattice_hyp</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <briefdescription>
<para>Get hypothesis string after bestpath search. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="853" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="853" bodyend="907"/>
        <references refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" compoundref="dict_8c" startline="411" endline="422">dict_real_word</references>
        <references refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" compoundref="ps__lattice__internal_8h" startline="66">ps_lattice_s::dict</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" compoundref="ps__lattice__internal_8h" startline="78">ps_lattice_s::hyp_str</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ac6ed71f947e66eee2257d588d57faf5a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ps_lattice_compute_lscr</definition>
        <argsstring>(ps_seg_t *seg, ps_latlink_t *link, int to)</argsstring>
        <name>ps_lattice_compute_lscr</name>
        <param>
          <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
          <declname>seg</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type>int</type>
          <declname>to</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="910" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="910" bodyend="954"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a02db37026bd85b5e3701f7a9ee15ee09" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ps_lattice_link2itor</definition>
        <argsstring>(ps_seg_t *seg, ps_latlink_t *link, int to)</argsstring>
        <name>ps_lattice_link2itor</name>
        <param>
          <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
          <declname>seg</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type>int</type>
          <declname>to</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="957" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="957" bodyend="991"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ac8a262da7cd25960b0722bfb9acf7717" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ps_lattice_seg_free</definition>
        <argsstring>(ps_seg_t *seg)</argsstring>
        <name>ps_lattice_seg_free</name>
        <param>
          <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
          <declname>seg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="994" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="994" bodyend="1000"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a25fed410bd6d885ffb0c8d81c3f7635f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
        <definition>static ps_seg_t* ps_lattice_seg_next</definition>
        <argsstring>(ps_seg_t *seg)</argsstring>
        <name>ps_lattice_seg_next</name>
        <param>
          <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
          <declname>seg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1003" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1003" bodyend="1021"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1afedbc5558c18f7d029e84a4e27e38187" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
        <definition>ps_seg_t* ps_lattice_seg_iter</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link, float32 lwf)</argsstring>
        <name>ps_lattice_seg_iter</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>lwf</declname>
        </param>
        <briefdescription>
<para>Get hypothesis segmentation iterator after bestpath search. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1029" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1029" bodyend="1062"/>
        <references refid="structdag__seg__s_1a72f90e137c1f83ab3df6ecd5e1b6dc71" compoundref="ps__lattice__internal_8h" startline="140">dag_seg_s::base</references>
        <references refid="structps__seg__s_1a510362a2281e374c839397c3e5488515" compoundref="pocketsphinx__internal_8h" startline="180">ps_seg_s::vt</references>
        <references refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" compoundref="pocketsphinx__internal_8h" startline="181">ps_seg_s::search</references>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="structps__seg__s_1a2249c012b83c902f4f8ed8d98ded7d20" compoundref="pocketsphinx__internal_8h" startline="192">ps_seg_s::lwf</references>
        <references refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" compoundref="ps__lattice__internal_8h" startline="143">dag_seg_s::n_links</references>
        <references refid="structdag__seg__s_1a4517656eeaa40d33109d39a251a75dea" compoundref="ps__lattice__internal_8h" startline="142">dag_seg_s::norm</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
        <references refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" compoundref="ps__lattice__internal_8h" startline="141">dag_seg_s::links</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a7197508af770064ea825bb812dd6eddc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice__internal_8h_1a32dd9511afc2f024dc63c9c060261e94" kindref="member">latlink_list_t</ref> *</type>
        <definition>latlink_list_t* latlink_list_new</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link, latlink_list_t *next)</argsstring>
        <name>latlink_list_new</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a32dd9511afc2f024dc63c9c060261e94" kindref="member">latlink_list_t</ref> *</type>
          <declname>next</declname>
        </param>
        <briefdescription>
<para>Create a new lattice link element. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1065" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1065" bodyend="1074"/>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <referencedby refid="ps__lattice__internal_8h_1a04896ebe0e2592bc7950d413b5d5c52e" compoundref="ps__lattice_8c" startline="1077" endline="1086">ps_lattice_pushq</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_lattice_pushq</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link)</argsstring>
        <name>ps_lattice_pushq</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <briefdescription>
<para>Add an edge to the traversal queue. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1077" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1077" bodyend="1086"/>
        <references refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" compoundref="ps__lattice__internal_8h" startline="85">ps_lattice_s::q_head</references>
        <references refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" compoundref="ps__lattice__internal_8h" startline="86">ps_lattice_s::q_tail</references>
        <references refid="ps__lattice_8c_1a7197508af770064ea825bb812dd6eddc" compoundref="ps__lattice_8c" startline="1065" endline="1074">latlink_list_new</references>
        <referencedby refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" compoundref="ps__lattice_8c" startline="1114" endline="1137">ps_lattice_traverse_edges</referencedby>
        <referencedby refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" compoundref="ps__lattice_8c" startline="1140" endline="1168">ps_lattice_traverse_next</referencedby>
        <referencedby refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" compoundref="ps__lattice_8c" startline="1171" endline="1193">ps_lattice_reverse_edges</referencedby>
        <referencedby refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" compoundref="ps__lattice_8c" startline="1196" endline="1224">ps_lattice_reverse_next</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_lattice_popq</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_popq</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Remove an edge from the traversal queue. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1089" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1089" bodyend="1103"/>
        <references refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" compoundref="ps__lattice__internal_8h" startline="85">ps_lattice_s::q_head</references>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <references refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" compoundref="ps__lattice__internal_8h" startline="86">ps_lattice_s::q_tail</references>
        <referencedby refid="ps__lattice__internal_8h_1ad128ca75e8bc7ca4ba41094fb5b68ee9" compoundref="ps__lattice_8c" startline="1106" endline="1111">ps_lattice_delq</referencedby>
        <referencedby refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" compoundref="ps__lattice_8c" startline="1140" endline="1168">ps_lattice_traverse_next</referencedby>
        <referencedby refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" compoundref="ps__lattice_8c" startline="1196" endline="1224">ps_lattice_reverse_next</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_lattice_delq</definition>
        <argsstring>(ps_lattice_t *dag)</argsstring>
        <name>ps_lattice_delq</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <briefdescription>
<para>Clear and reset the traversal queue. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1106" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1106" bodyend="1111"/>
        <references refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" compoundref="ps__lattice_8c" startline="1089" endline="1103">ps_lattice_popq</references>
        <referencedby refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" compoundref="ps__lattice_8c" startline="1114" endline="1137">ps_lattice_traverse_edges</referencedby>
        <referencedby refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" compoundref="ps__lattice_8c" startline="1140" endline="1168">ps_lattice_traverse_next</referencedby>
        <referencedby refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" compoundref="ps__lattice_8c" startline="1171" endline="1193">ps_lattice_reverse_edges</referencedby>
        <referencedby refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" compoundref="ps__lattice_8c" startline="1196" endline="1224">ps_lattice_reverse_next</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_lattice_traverse_edges</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *start, ps_latnode_t *end)</argsstring>
        <name>ps_lattice_traverse_edges</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>start</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>end</declname>
        </param>
        <briefdescription>
<para>Start a forward traversal of edges in a word graph. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>A keen eye will notice an inconsistency in this API versus other types of iterators in PocketSphinx. The reason for this is that the traversal algorithm is much more efficient when it is able to modify the lattice structure. Therefore, to avoid giving the impression that multiple traversals are possible at once, no separate iterator structure is provided.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to be traversed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>start</parametername>
</parameternamelist>
<parameterdescription>
<para>Start node (source) of traversal. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>end</parametername>
</parameternamelist>
<parameterdescription>
<para>End node (goal) of traversal. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>First link in traversal. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1114" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1114" bodyend="1137"/>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" compoundref="ps__lattice__internal_8h" startline="125">ps_latnode_s::fanin</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" compoundref="ps__lattice_8c" startline="1106" endline="1111">ps_lattice_delq</references>
        <references refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" compoundref="ps__lattice_8c" startline="1077" endline="1086">ps_lattice_pushq</references>
        <references refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" compoundref="ps__lattice_8c" startline="1140" endline="1168">ps_lattice_traverse_next</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <referencedby refid="ps__lattice_8c_1a0cc8e4824f4f23ecbf511b0bb096a3ea" compoundref="ps__lattice_8c" startline="1238" endline="1370">ps_lattice_bestpath</referencedby>
        <referencedby refid="ps__lattice_8c_1a54c24dc8436c39d0ccc044f7b0ef8f3a" compoundref="ps__lattice_8c" startline="1477" endline="1518">ps_lattice_posterior_prune</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_lattice_traverse_next</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *end)</argsstring>
        <name>ps_lattice_traverse_next</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>end</declname>
        </param>
        <briefdescription>
<para>Get the next link in forward traversal. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to be traversed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>end</parametername>
</parameternamelist>
<parameterdescription>
<para>End node (goal) of traversal. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Next link in traversal. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1140" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1140" bodyend="1168"/>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" compoundref="ps__lattice__internal_8h" startline="125">ps_latnode_s::fanin</references>
        <references refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" compoundref="ps__lattice_8c" startline="1106" endline="1111">ps_lattice_delq</references>
        <references refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" compoundref="ps__lattice_8c" startline="1089" endline="1103">ps_lattice_popq</references>
        <references refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" compoundref="ps__lattice_8c" startline="1077" endline="1086">ps_lattice_pushq</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <referencedby refid="ps__lattice_8c_1a0cc8e4824f4f23ecbf511b0bb096a3ea" compoundref="ps__lattice_8c" startline="1238" endline="1370">ps_lattice_bestpath</referencedby>
        <referencedby refid="ps__lattice_8c_1a54c24dc8436c39d0ccc044f7b0ef8f3a" compoundref="ps__lattice_8c" startline="1477" endline="1518">ps_lattice_posterior_prune</referencedby>
        <referencedby refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" compoundref="ps__lattice_8c" startline="1114" endline="1137">ps_lattice_traverse_edges</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_lattice_reverse_edges</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *start, ps_latnode_t *end)</argsstring>
        <name>ps_lattice_reverse_edges</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>start</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>end</declname>
        </param>
        <briefdescription>
<para>Start a reverse traversal of edges in a word graph. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>See <ref refid="ps__lattice_8h_1a997fce2eb1eaf316d463ddfb3d8395b8" kindref="member">ps_lattice_traverse_edges()</ref> for why this API is the way it is.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to be traversed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>start</parametername>
</parameternamelist>
<parameterdescription>
<para>Start node (goal) of traversal. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>end</parametername>
</parameternamelist>
<parameterdescription>
<para>End node (source) of traversal. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>First link in traversal. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1171" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1171" bodyend="1193"/>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" compoundref="ps__lattice__internal_8h" startline="125">ps_latnode_s::fanin</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" compoundref="ps__lattice_8c" startline="1106" endline="1111">ps_lattice_delq</references>
        <references refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" compoundref="ps__lattice_8c" startline="1077" endline="1086">ps_lattice_pushq</references>
        <references refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" compoundref="ps__lattice_8c" startline="1196" endline="1224">ps_lattice_reverse_next</references>
        <referencedby refid="ps__lattice_8c_1aafee8a8325301db72711a3680bc385c6" compoundref="ps__lattice_8c" startline="1408" endline="1474">ps_lattice_posterior</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_lattice_reverse_next</definition>
        <argsstring>(ps_lattice_t *dag, ps_latnode_t *start)</argsstring>
        <name>ps_lattice_reverse_next</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>start</declname>
        </param>
        <briefdescription>
<para>Get the next link in reverse traversal. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dag</parametername>
</parameternamelist>
<parameterdescription>
<para>Lattice to be traversed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>start</parametername>
</parameternamelist>
<parameterdescription>
<para>Start node (goal) of traversal. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Next link in traversal. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1196" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1196" bodyend="1224"/>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" compoundref="ps__lattice__internal_8h" startline="125">ps_latnode_s::fanin</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" compoundref="ps__lattice_8c" startline="1106" endline="1111">ps_lattice_delq</references>
        <references refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" compoundref="ps__lattice_8c" startline="1089" endline="1103">ps_lattice_popq</references>
        <references refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" compoundref="ps__lattice_8c" startline="1077" endline="1086">ps_lattice_pushq</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <referencedby refid="ps__lattice_8c_1aafee8a8325301db72711a3680bc385c6" compoundref="ps__lattice_8c" startline="1408" endline="1474">ps_lattice_posterior</referencedby>
        <referencedby refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" compoundref="ps__lattice_8c" startline="1171" endline="1193">ps_lattice_reverse_edges</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a0cc8e4824f4f23ecbf511b0bb096a3ea" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
        <definition>ps_latlink_t* ps_lattice_bestpath</definition>
        <argsstring>(ps_lattice_t *dag, ngram_model_t *lmset, float32 lwf, float32 ascale)</argsstring>
        <name>ps_lattice_bestpath</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>ngram_model_t *</type>
          <declname>lmset</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>lwf</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>ascale</declname>
        </param>
        <briefdescription>
<para>Do N-Gram based best-path search on a word graph. </para>        </briefdescription>
        <detaileddescription>
<para>This function calculates both the best path as well as the forward probability used in confidence estimation.</para><para><simplesect kind="return"><para>Final link in best path, NULL on error. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1238" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1238" bodyend="1370"/>
        <references refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" compoundref="ps__lattice__internal_8h" startline="103">ps_latlink_s::alpha</references>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" compoundref="hmm_8h" startline="99">BETTER_THAN</references>
        <references refid="structps__search__s_1a918f243fa966e72c47f697fb9e60089d" compoundref="pocketsphinx__internal_8h" startline="111">ps_search_s::dict</references>
        <references refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" compoundref="dict_8c" startline="397" endline="408">dict_filler_word</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__lattice__s_1aba113d4134c72d7405423c77bcc1247e" compoundref="ps__lattice__internal_8h" startline="76">ps_lattice_s::final_node_ascr</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" compoundref="ps__lattice__internal_8h" startline="119">ps_latnode_s::lef</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
        <references refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" compoundref="ps__lattice__internal_8h" startline="101">ps_latlink_s::path_scr</references>
        <references refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" compoundref="ps__lattice_8c" startline="1114" endline="1137">ps_lattice_traverse_edges</references>
        <references refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" compoundref="ps__lattice_8c" startline="1140" endline="1168">ps_lattice_traverse_next</references>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" compoundref="hmm_8h" startline="77">SENSCR_SHIFT</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
        <references refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" compoundref="ps__lattice__internal_8h" startline="115">ps_latnode_s::wid</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a10e43cd0255eb177dd6b2c533049f809" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>static int32 ps_lattice_joint</definition>
        <argsstring>(ps_lattice_t *dag, ps_latlink_t *link, float32 ascale)</argsstring>
        <name>ps_lattice_joint</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1a58ba3066b0b611f07c7ae57d77f8e776" kindref="member">ps_latlink_t</ref> *</type>
          <declname>link</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>ascale</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1373" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1373" bodyend="1405"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1aafee8a8325301db72711a3680bc385c6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 ps_lattice_posterior</definition>
        <argsstring>(ps_lattice_t *dag, ngram_model_t *lmset, float32 ascale)</argsstring>
        <name>ps_lattice_posterior</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>ngram_model_t *</type>
          <declname>lmset</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>ascale</declname>
        </param>
        <briefdescription>
<para>Calculate link posterior probabilities on a word graph. </para>        </briefdescription>
        <detaileddescription>
<para>This function assumes that bestpath search has already been done.</para><para><simplesect kind="return"><para>Posterior probability of the utterance as a whole. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1408" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1408" bodyend="1474"/>
        <references refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" compoundref="ps__lattice__internal_8h" startline="100">ps_latlink_s::ascr</references>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" compoundref="ps__lattice__internal_8h" startline="104">ps_latlink_s::beta</references>
        <references refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" compoundref="hmm_8h" startline="99">BETTER_THAN</references>
        <references refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" compoundref="dict_8c" startline="397" endline="408">dict_filler_word</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__lattice__s_1aba113d4134c72d7405423c77bcc1247e" compoundref="ps__lattice__internal_8h" startline="76">ps_lattice_s::final_node_ascr</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" compoundref="ps__lattice__internal_8h" startline="64">ps_lattice_s::lmath</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
        <references refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" compoundref="ps__lattice__internal_8h" startline="101">ps_latlink_s::path_scr</references>
        <references refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" compoundref="ps__lattice_8c" startline="1171" endline="1193">ps_lattice_reverse_edges</references>
        <references refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" compoundref="ps__lattice_8c" startline="1196" endline="1224">ps_lattice_reverse_next</references>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" compoundref="hmm_8h" startline="77">SENSCR_SHIFT</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a54c24dc8436c39d0ccc044f7b0ef8f3a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 ps_lattice_posterior_prune</definition>
        <argsstring>(ps_lattice_t *dag, int32 beam)</argsstring>
        <name>ps_lattice_posterior_prune</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>beam</declname>
        </param>
        <briefdescription>
<para>Prune all links (and associated nodes) below a certain posterior probability. </para>        </briefdescription>
        <detaileddescription>
<para>This function assumes that <ref refid="ps__lattice_8h_1a8c5c6ef260ab006099ab34d09b5b1d06" kindref="member">ps_lattice_posterior()</ref> has already been called.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>beam</parametername>
</parameternamelist>
<parameterdescription>
<para>Minimum posterior probability for links. This is expressed in the log-base used in the decoder. To convert from linear floating-point, use logmath_log(ps_lattice_get_logmath(), prob). </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>number of arcs removed. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1477" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1477" bodyend="1518"/>
        <references refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" compoundref="ps__lattice__internal_8h" startline="103">ps_latlink_s::alpha</references>
        <references refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" compoundref="ps__lattice__internal_8h" startline="104">ps_latlink_s::beta</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" compoundref="ps__lattice__internal_8h" startline="130">ps_latnode_s::entries</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" compoundref="ps__lattice__internal_8h" startline="97">ps_latlink_s::from</references>
        <references refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" compoundref="ps__lattice__internal_8h" startline="81">ps_lattice_s::latlink_alloc</references>
        <references refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" compoundref="ps__lattice__internal_8h" startline="82">ps_lattice_s::latlink_list_alloc</references>
        <references refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" compoundref="ps__lattice__internal_8h" startline="77">ps_lattice_s::norm</references>
        <references refid="ps__lattice_8c_1a6da4e36322aaab4d2ebe812bee9a4439" compoundref="ps__lattice_8c" startline="197" endline="230">ps_lattice_delete_unreachable</references>
        <references refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" compoundref="ps__lattice_8c" startline="1114" endline="1137">ps_lattice_traverse_edges</references>
        <references refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" compoundref="ps__lattice_8c" startline="1140" endline="1168">ps_lattice_traverse_next</references>
        <references refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" compoundref="ps__lattice__internal_8h" startline="121">ps_latnode_s::reachable</references>
        <references refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" compoundref="ps__lattice__internal_8h" startline="71">ps_lattice_s::start</references>
        <references refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" compoundref="ps__lattice__internal_8h" startline="98">ps_latlink_s::to</references>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ab3bda0dead3dae5981e7d56d3a34bef4" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>static int32 best_rem_score</definition>
        <argsstring>(ps_astar_t *nbest, ps_latnode_t *from)</argsstring>
        <name>best_rem_score</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>nbest</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice_8h_1ad570c45dd72ad9ea8d57391fd2cd1c07" kindref="member">ps_latnode_t</ref> *</type>
          <declname>from</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1532" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1532" bodyend="1557"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a3720b5500adc4614e2c1de8c2f5bbfe6" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void path_insert</definition>
        <argsstring>(ps_astar_t *nbest, ps_latpath_t *newpath, int32 total_score)</argsstring>
        <name>path_insert</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>nbest</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1aba5a485290f665fb2e7e514a32ba3073" kindref="member">ps_latpath_t</ref> *</type>
          <declname>newpath</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>total_score</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1565" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1565" bodyend="1606"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a6488b259b3569b1cacbe9caaffb0db88" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void path_extend</definition>
        <argsstring>(ps_astar_t *nbest, ps_latpath_t *path)</argsstring>
        <name>path_extend</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>nbest</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1aba5a485290f665fb2e7e514a32ba3073" kindref="member">ps_latpath_t</ref> *</type>
          <declname>path</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1610" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1610" bodyend="1662"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1aaf9aedd3cd8bd1d45053e10828215a25" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
        <definition>ps_astar_t* ps_astar_start</definition>
        <argsstring>(ps_lattice_t *dag, ngram_model_t *lmset, float32 lwf, int sf, int ef, int w1, int w2)</argsstring>
        <name>ps_astar_start</name>
        <param>
          <type><ref refid="ps__lattice_8h_1af3c03aa650aafdaea0cbcfabe1a1c1e5" kindref="member">ps_lattice_t</ref> *</type>
          <declname>dag</declname>
        </param>
        <param>
          <type>ngram_model_t *</type>
          <declname>lmset</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>lwf</declname>
        </param>
        <param>
          <type>int</type>
          <declname>sf</declname>
        </param>
        <param>
          <type>int</type>
          <declname>ef</declname>
        </param>
        <param>
          <type>int</type>
          <declname>w1</declname>
        </param>
        <param>
          <type>int</type>
          <declname>w2</declname>
        </param>
        <briefdescription>
<para>Begin N-Gram based A* search on a word graph. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>sf</parametername>
</parameternamelist>
<parameterdescription>
<para>Starting frame for N-best search. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ef</parametername>
</parameternamelist>
<parameterdescription>
<para>Ending frame for N-best search, or -1 for last frame. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>w1</parametername>
</parameternamelist>
<parameterdescription>
<para>First context word, or -1 for none. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>w2</parametername>
</parameternamelist>
<parameterdescription>
<para>Second context word, or -1 for none. </para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 for success, &lt;0 on error. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1665" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1665" bodyend="1721"/>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" compoundref="ps__lattice__internal_8h" startline="129">ps_latnode_s::exits</references>
        <references refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" compoundref="ps__lattice__internal_8h" startline="184">ps_astar_s::latpath_alloc</references>
        <references refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" compoundref="ps__lattice__internal_8h" startline="74">ps_lattice_s::n_frames</references>
        <references refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" compoundref="ps__lattice__internal_8h" startline="133">ps_latnode_s::next</references>
        <references refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" compoundref="ps__lattice__internal_8h" startline="154">ps_latpath_s::node</references>
        <references refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" compoundref="ps__lattice__internal_8h" startline="70">ps_lattice_s::nodes</references>
        <references refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" compoundref="ps__lattice__internal_8h" startline="155">ps_latpath_s::parent</references>
        <references refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" compoundref="ps__lattice__internal_8h" startline="126">ps_latnode_s::rem_score</references>
        <references refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" compoundref="ps__lattice__internal_8h" startline="157">ps_latpath_s::score</references>
        <references refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" compoundref="hmm_8h" startline="77">SENSCR_SHIFT</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
        <references refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" compoundref="hmm_8h" startline="88">WORST_SCORE</references>
        <referencedby refid="pocketsphinx_8h_1af4bb6ba47844a135745db428919d9810" compoundref="pocketsphinx_8c" startline="1151" endline="1181">ps_nbest</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a6bea95f8fb827af790bbe6ce1920908c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="ps__lattice__internal_8h_1aba5a485290f665fb2e7e514a32ba3073" kindref="member">ps_latpath_t</ref> *</type>
        <definition>ps_latpath_t* ps_astar_next</definition>
        <argsstring>(ps_astar_t *nbest)</argsstring>
        <name>ps_astar_next</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>nbest</declname>
        </param>
        <briefdescription>
<para>Find next best hypothesis of A* on a word graph. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>a complete path, or NULL if no more hypotheses exist. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1724" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1724" bodyend="1754"/>
        <references refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" compoundref="ps__lattice__internal_8h" startline="72">ps_lattice_s::end</references>
        <references refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" compoundref="ps__lattice__internal_8h" startline="118">ps_latnode_s::fef</references>
        <references refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" compoundref="ps__lattice__internal_8h" startline="156">ps_latpath_s::next</references>
        <references refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" compoundref="ps__lattice__internal_8h" startline="154">ps_latpath_s::node</references>
        <references refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" compoundref="ps__lattice__internal_8h" startline="120">ps_latnode_s::sf</references>
        <referencedby refid="pocketsphinx_8h_1a0942b8c0570009319a5be20ef1b52821" compoundref="pocketsphinx_8c" startline="1190" endline="1200">ps_nbest_next</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ac7372b5c5ec111f6814ce1ba495593e4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char const *</type>
        <definition>char const* ps_astar_hyp</definition>
        <argsstring>(ps_astar_t *nbest, ps_latpath_t *path)</argsstring>
        <name>ps_astar_hyp</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>nbest</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1aba5a485290f665fb2e7e514a32ba3073" kindref="member">ps_latpath_t</ref> *</type>
          <declname>path</declname>
        </param>
        <briefdescription>
<para>Get hypothesis string from A* search. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1757" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1757" bodyend="1801"/>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" compoundref="ps__lattice__internal_8h" startline="155">ps_latpath_s::parent</references>
        <references refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" compoundref="dict_8c" startline="411" endline="422">dict_real_word</references>
        <references refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" compoundref="ps__lattice__internal_8h" startline="154">ps_latpath_s::node</references>
        <references refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" compoundref="ps__lattice__internal_8h" startline="116">ps_latnode_s::basewid</references>
        <references refid="structps__astar__s_1ace603617a74a81575519ae1bb94720c4" compoundref="ps__lattice__internal_8h" startline="183">ps_astar_s::hyps</references>
        <referencedby refid="pocketsphinx_8h_1a250c5f72d3addd0d0254f3ceeaa17ace" compoundref="pocketsphinx_8c" startline="1203" endline="1211">ps_nbest_hyp</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1aff353bca425550c21823bf9ee79713bd" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ps_astar_node2itor</definition>
        <argsstring>(astar_seg_t *itor)</argsstring>
        <name>ps_astar_node2itor</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1ac9ad8a97a222c2fa9e5c2bb66d26d74d" kindref="member">astar_seg_t</ref> *</type>
          <declname>itor</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1804" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1804" bodyend="1818"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a2292a2bb510c29f701a46e072fccb1ff" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void ps_astar_seg_free</definition>
        <argsstring>(ps_seg_t *seg)</argsstring>
        <name>ps_astar_seg_free</name>
        <param>
          <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
          <declname>seg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1821" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1821" bodyend="1826"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1a8c71ea29d1ffcf5e9d0cc00c70b4014a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
        <definition>static ps_seg_t* ps_astar_seg_next</definition>
        <argsstring>(ps_seg_t *seg)</argsstring>
        <name>ps_astar_seg_next</name>
        <param>
          <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
          <declname>seg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1829" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1829" bodyend="1843"/>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1ac8e3dff7276c03c93377d0cb79fbdbd7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="pocketsphinx_8h_1a64d3ac229ef945017112bab4c2a5ec94" kindref="member">ps_seg_t</ref> *</type>
        <definition>ps_seg_t* ps_astar_seg_iter</definition>
        <argsstring>(ps_astar_t *astar, ps_latpath_t *path, float32 lwf)</argsstring>
        <name>ps_astar_seg_iter</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>astar</declname>
        </param>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1aba5a485290f665fb2e7e514a32ba3073" kindref="member">ps_latpath_t</ref> *</type>
          <declname>path</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>lwf</declname>
        </param>
        <briefdescription>
<para>Get hypothesis segmentation from A* search. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1851" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1851" bodyend="1875"/>
        <references refid="structps__seg__s_1a510362a2281e374c839397c3e5488515" compoundref="pocketsphinx__internal_8h" startline="180">ps_seg_s::vt</references>
        <references refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" compoundref="pocketsphinx__internal_8h" startline="181">ps_seg_s::search</references>
        <references refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" compoundref="ps__lattice__internal_8h" startline="65">ps_lattice_s::search</references>
        <references refid="structps__seg__s_1a2249c012b83c902f4f8ed8d98ded7d20" compoundref="pocketsphinx__internal_8h" startline="192">ps_seg_s::lwf</references>
        <references refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" compoundref="ps__lattice__internal_8h" startline="155">ps_latpath_s::parent</references>
        <references refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" compoundref="ps__lattice__internal_8h" startline="154">ps_latpath_s::node</references>
        <referencedby refid="pocketsphinx_8h_1a1d2b6fd873d8213bd53a915ff2758785" compoundref="pocketsphinx_8c" startline="1214" endline="1220">ps_nbest_seg</referencedby>
      </memberdef>
      <memberdef kind="function" id="ps__lattice_8c_1abfb03e9e0fcbe3def45120f5ba43be14" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ps_astar_finish</definition>
        <argsstring>(ps_astar_t *nbest)</argsstring>
        <name>ps_astar_finish</name>
        <param>
          <type><ref refid="ps__lattice__internal_8h_1a756a1b6f5dfe4e3f35052380f9acb8de" kindref="member">ps_astar_t</ref> *</type>
          <declname>nbest</declname>
        </param>
        <briefdescription>
<para>Finish N-best search, releasing resources associated with it. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" line="1878" column="1" bodyfile="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c" bodystart="1878" bodyend="1891"/>
        <references refid="structps__astar__s_1ace603617a74a81575519ae1bb94720c4" compoundref="ps__lattice__internal_8h" startline="183">ps_astar_s::hyps</references>
        <references refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" compoundref="ps__lattice__internal_8h" startline="184">ps_astar_s::latpath_alloc</references>
        <referencedby refid="pocketsphinx_8h_1a83379b2da95eebdf5070d29196a9b067" compoundref="pocketsphinx_8c" startline="1184" endline="1187">ps_nbest_free</referencedby>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Word graph search. </para>    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>-*-<sp/>c-basic-offset:<sp/>4;<sp/>indent-tabs-mode:<sp/>nil<sp/>-*-<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>====================================================================</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2008<sp/>Carnegie<sp/>Mellon<sp/>University.<sp/><sp/>All<sp/>rights</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>reserved.</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.<sp/></highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>distribution.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>This<sp/>work<sp/>was<sp/>supported<sp/>in<sp/>part<sp/>by<sp/>funding<sp/>from<sp/>the<sp/>Defense<sp/>Advanced<sp/></highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>Research<sp/>Projects<sp/>Agency<sp/>and<sp/>the<sp/>National<sp/>Science<sp/>Foundation<sp/>of<sp/>the<sp/></highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>United<sp/>States<sp/>of<sp/>America,<sp/>and<sp/>the<sp/>CMU<sp/>Sphinx<sp/>Speech<sp/>Consortium.</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>CARNEGIE<sp/>MELLON<sp/>UNIVERSITY<sp/>``AS<sp/>IS&apos;&apos;<sp/>AND<sp/></highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>ANY<sp/>EXPRESSED<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/></highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/><sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>CARNEGIE<sp/>MELLON<sp/>UNIVERSITY</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>NOR<sp/>ITS<sp/>EMPLOYEES<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/></highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/></highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>DATA,<sp/>OR<sp/>PROFITS;<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/></highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/></highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/></highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*<sp/>====================================================================</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="comment">/*<sp/>System<sp/>headers.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;assert.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>SphinxBase<sp/>headers.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sphinxbase/ckd_alloc.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sphinxbase/listelem_alloc.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sphinxbase/strfuncs.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sphinxbase/err.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;sphinxbase/pio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Local<sp/>headers.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="pocketsphinx__internal_8h" kindref="compound">pocketsphinx_internal.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ps__lattice__internal_8h" kindref="compound">ps_lattice_internal.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ngram__search_8h" kindref="compound">ngram_search.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dict_8h" kindref="compound">dict.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/>Create<sp/>a<sp/>directed<sp/>link<sp/>between<sp/>&quot;from&quot;<sp/>and<sp/>&quot;to&quot;<sp/>nodes,<sp/>but<sp/>if<sp/>a<sp/>link<sp/>already<sp/>exists,</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/>choose<sp/>one<sp/>with<sp/>the<sp/>best<sp/>ascr.</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" kindref="member">ps_lattice_link</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*from,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*to,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>score,<sp/>int32<sp/>ef)</highlight></codeline>
<codeline lineno="67"><highlight class="normal">{</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*fwdlink;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Look<sp/>for<sp/>an<sp/>existing<sp/>link<sp/>between<sp/>&quot;from&quot;<sp/>and<sp/>&quot;to&quot;<sp/>nodes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(fwdlink<sp/>=<sp/>from-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>fwdlink;<sp/>fwdlink<sp/>=<sp/>fwdlink-&gt;next)</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fwdlink-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>==<sp/>to)</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fwdlink<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*revlink;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>link<sp/>between<sp/>the<sp/>two<sp/>nodes;<sp/>create<sp/>a<sp/>new<sp/>one<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link<sp/>=<sp/>listelem_malloc(dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref>);</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwdlink<sp/>=<sp/>listelem_malloc(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>revlink<sp/>=<sp/>listelem_malloc(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>=<sp/>from;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>=<sp/>to;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>=<sp/>score;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" kindref="member">ef</ref><sp/>=<sp/>ef;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;best_prev<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwdlink-&gt;link<sp/>=<sp/>revlink-&gt;link<sp/>=<sp/>link;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwdlink-&gt;next<sp/>=<sp/>from-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref><sp/>=<sp/>fwdlink;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>revlink-&gt;next<sp/>=<sp/>to-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref><sp/>=<sp/>revlink;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Link<sp/>already<sp/>exists;<sp/>just<sp/>retain<sp/>the<sp/>best<sp/>ascr<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(score<sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>fwdlink-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwdlink-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>=<sp/>score;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwdlink-&gt;link-&gt;<ref refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" kindref="member">ef</ref><sp/>=<sp/>ef;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="103"><highlight class="normal">}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106" refid="ps__lattice__internal_8h_1a9b40adaa059978fe33959d59da1b6919" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a9b40adaa059978fe33959d59da1b6919" kindref="member">ps_lattice_bypass_fillers</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/>int32<sp/>silpen,<sp/>int32<sp/>fillpen)</highlight></codeline>
<codeline lineno="107"><highlight class="normal">{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>score;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Bypass<sp/>filler<sp/>nodes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*revlink;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(node<sp/>==<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref><sp/>||<sp/>!<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>node-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Replace<sp/>each<sp/>link<sp/>entering<sp/>filler<sp/>node<sp/>with<sp/>links<sp/>to<sp/>all<sp/>its<sp/>successors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(revlink<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>revlink;<sp/>revlink<sp/>=<sp/>revlink-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*forlink;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*rlink<sp/>=<sp/>revlink-&gt;link;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>=<sp/>(node-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref><sp/>==<sp/>dag-&gt;<ref refid="structps__lattice__s_1acd3f3ab2649f649ba33bf2a422cf12b8" kindref="member">silence</ref>)<sp/>?<sp/>silpen<sp/>:<sp/>fillpen;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>+=<sp/>rlink-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="125"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Make<sp/>links<sp/>from<sp/>predecessor<sp/>of<sp/>filler<sp/>(from)<sp/>to<sp/>successors<sp/>of<sp/>filler.</highlight></codeline>
<codeline lineno="126"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>But<sp/>if<sp/>successor<sp/>is<sp/>a<sp/>filler,<sp/>it<sp/>has<sp/>already<sp/>been<sp/>eliminated<sp/>since<sp/>it</highlight></codeline>
<codeline lineno="127"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>appears<sp/>earlier<sp/>in<sp/>latnode_list<sp/>(see<sp/>build...).<sp/><sp/>So<sp/>it<sp/>can<sp/>be<sp/>skipped.</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(forlink<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>forlink;<sp/>forlink<sp/>=<sp/>forlink-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*flink<sp/>=<sp/>forlink-&gt;link;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flink-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>&amp;&amp;<sp/>rlink-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>flink-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" kindref="member">ps_lattice_link</ref>(dag,<sp/>rlink-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>,<sp/>flink-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>,</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>+<sp/>flink-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>,<sp/>flink-&gt;<ref refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" kindref="member">ef</ref>);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref><sp/>=<sp/>FALSE;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal">}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal">delete_node(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node)</highlight></codeline>
<codeline lineno="144"><highlight class="normal">{</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x,<sp/>*next_x;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>next_x)<sp/>{</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_x<sp/>=<sp/>x-&gt;next;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>x);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>x;<sp/>x<sp/>=<sp/>next_x)<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_x<sp/>=<sp/>x-&gt;next;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>x);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" kindref="member">latnode_alloc</ref>,<sp/>node);</highlight></codeline>
<codeline lineno="158"><highlight class="normal">}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal">remove_dangling_links(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node)</highlight></codeline>
<codeline lineno="163"><highlight class="normal">{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x,<sp/>*prev_x,<sp/>*next_x;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_x<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>next_x)<sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_x<sp/>=<sp/>x-&gt;next;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev_x)</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_x-&gt;next<sp/>=<sp/>next_x;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref><sp/>=<sp/>next_x;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref>,<sp/>x-&gt;link);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>x);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_x<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_x<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>x;<sp/>x<sp/>=<sp/>next_x)<sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_x<sp/>=<sp/>x-&gt;next;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev_x)</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_x-&gt;next<sp/>=<sp/>next_x;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref><sp/>=<sp/>next_x;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref>,<sp/>x-&gt;link);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>x);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_x<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal">}</highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197" refid="ps__lattice__internal_8h_1a6da4e36322aaab4d2ebe812bee9a4439" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a6da4e36322aaab4d2ebe812bee9a4439" kindref="member">ps_lattice_delete_unreachable</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="198"><highlight class="normal">{</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node,<sp/>*prev_node,<sp/>*next_node;</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>unreachable<sp/>nodes<sp/>from<sp/>the<sp/>list<sp/>of<sp/>nodes.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_node<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>next_node)<sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!node-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev_node)</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref><sp/>=<sp/>next_node;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref><sp/>=<sp/>next_node;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Delete<sp/>this<sp/>node<sp/>and<sp/>NULLify<sp/>links<sp/>to<sp/>it.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>delete_node(dag,<sp/>node);</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_node<sp/>=<sp/>node;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>all<sp/>links<sp/>to<sp/>and<sp/>from<sp/>unreachable<sp/>nodes.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Assign<sp/>sequence<sp/>numbers.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref><sp/>=<sp/>i++;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>should<sp/>obviously<sp/>not<sp/>encounter<sp/>unreachable<sp/>nodes<sp/>here!<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(node-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Remove<sp/>all<sp/>links<sp/>that<sp/>go<sp/>nowhere.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remove_dangling_links(dag,<sp/>node);</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="230"><highlight class="normal">}</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="233" refid="ps__lattice_8c_1a520b99eff2c1dba89927f0f3d258b8aa" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a520b99eff2c1dba89927f0f3d258b8aa" kindref="member">ps_lattice_write</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*filename)</highlight></codeline>
<codeline lineno="234"><highlight class="normal">{</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*fp;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*d,<sp/>*initial,<sp/>*</highlight><highlight class="keyword">final</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/>initial<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/>E_INFO(</highlight><highlight class="stringliteral">&quot;Writing<sp/>lattice<sp/>file:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>filename);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp<sp/>=<sp/>fopen(filename,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR_SYSTEM(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>open<sp/>lattice<sp/>file<sp/>&apos;%s&apos;<sp/>for<sp/>writing&quot;</highlight><highlight class="normal">,<sp/>filename);</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Stupid<sp/>Sphinx-III<sp/>lattice<sp/>code<sp/>expects<sp/>&apos;getcwd:&apos;<sp/>here<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#<sp/>getcwd:<sp/>/this/is/bogus\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#<sp/>-logbase<sp/>%e\n&quot;</highlight><highlight class="normal">,<sp/>logmath_get_base(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>));</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;Frames<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" kindref="member">n_frames</ref>);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>d<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>d;<sp/>d<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>,<sp/>i++);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Nodes<sp/>%d<sp/>(NODEID<sp/>WORD<sp/>STARTFRAME<sp/>FIRST-ENDFRAME<sp/>LAST-ENDFRAME)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>d<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>d;<sp/>d<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>,<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref><sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>%s<sp/>%d<sp/>%d<sp/>%d<sp/>;<sp/>%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i,<sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>),</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" kindref="member">fef</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" kindref="member">lef</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1a50d14c033652a4fb387f76881df1c3f6" kindref="member">node_id</ref>);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;Initial<sp/>%d\nFinal<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>initial-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>,<sp/>final-&gt;id);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Don&apos;t<sp/>bother<sp/>with<sp/>this,<sp/>it&apos;s<sp/>not<sp/>used<sp/>by<sp/>anything.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;BestSegAscr<sp/>%d<sp/>(NODEID<sp/>ENDFRAME<sp/>ASCORE)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0<sp/></highlight><highlight class="comment">/*<sp/>#BPTable<sp/>entries<sp/>*/</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;Edges<sp/>(FROM-NODEID<sp/>TO-NODEID<sp/>ASCORE)\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(d<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>d;<sp/>d<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*l;</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/><ref refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" kindref="member">WORSE_THAN</ref><sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref><sp/>||<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>0)</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>%d<sp/>%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>,<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>,<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;End\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/>fclose(fp);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="290"><highlight class="normal">}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="293" refid="ps__lattice_8c_1a1ac6d846fbecfcaba6094d84e93655f7" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a1ac6d846fbecfcaba6094d84e93655f7" kindref="member">ps_lattice_write_htk</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*filename)</highlight></codeline>
<codeline lineno="294"><highlight class="normal">{</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*fp;</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*d,<sp/>*initial,<sp/>*</highlight><highlight class="keyword">final</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>j,<sp/>n_links,<sp/>n_nodes;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>initial<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">final</highlight><highlight class="normal"><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>E_INFO(</highlight><highlight class="stringliteral">&quot;Writing<sp/>lattice<sp/>file:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>filename);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp<sp/>=<sp/>fopen(filename,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR_SYSTEM(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>open<sp/>lattice<sp/>file<sp/>&apos;%s&apos;<sp/>for<sp/>writing&quot;</highlight><highlight class="normal">,<sp/>filename);</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n_links<sp/>=<sp/>n_nodes<sp/>=<sp/>0,<sp/>d<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>d;<sp/>d<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*l;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!d-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref><sp/>=<sp/>n_nodes;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>==<sp/>NULL<sp/>||<sp/>!l-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/><ref refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" kindref="member">WORSE_THAN</ref><sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref><sp/>||<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>0)</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++n_links;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++n_nodes;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#<sp/>Lattice<sp/>generated<sp/>by<sp/>PocketSphinx\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n#<sp/>Header\n#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;VERSION=1.0\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;start=%d\n&quot;</highlight><highlight class="normal">,<sp/>initial-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;end=%d\n&quot;</highlight><highlight class="normal">,<sp/>final-&gt;id);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;N=%d\tL=%d\n&quot;</highlight><highlight class="normal">,<sp/>n_nodes,<sp/>n_links);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n#<sp/>Node<sp/>definitions\n#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(d<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>d;<sp/>d<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*word<sp/>=<sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>);</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*c<sp/>=<sp/>strrchr(word,<sp/></highlight><highlight class="charliteral">&apos;(&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>altpron<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!d-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c)</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>altpron<sp/>=<sp/>atoi(c<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>word<sp/>=<sp/>dict_basestr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref><sp/>==<sp/>dict_startwid(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>))</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>word<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;!SENT_START&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref><sp/>==<sp/>dict_finishwid(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>))</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>word<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;!SENT_END&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>))</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>word<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;!NULL&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;I=%d\tt=%.2f\tW=%s\tv=%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>,<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)d-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref><sp/>/<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" kindref="member">frate</ref>,</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>word,<sp/>altpron);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;#\n#<sp/>Link<sp/>definitions\n#\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0,<sp/>d<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>d;<sp/>d<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*l;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!d-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>==<sp/>NULL<sp/>||<sp/>!l-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/><ref refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" kindref="member">WORSE_THAN</ref><sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref><sp/>||<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>0)</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;J=%d\tS=%d\tE=%d\ta=%f\tp=%g\n&quot;</highlight><highlight class="normal">,<sp/>j++,</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>,<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref>,</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logmath_log_to_ln(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>,<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>),</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logmath_exp(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>,<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>l-&gt;link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>-<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>));</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>fclose(fp);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="370"><highlight class="normal">}</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Read<sp/>parameter<sp/>from<sp/>a<sp/>lattice<sp/>file*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal">dag_param_read(lineiter_t<sp/>*li,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*param)</highlight></codeline>
<codeline lineno="375"><highlight class="normal">{</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>n;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((li<sp/>=<sp/>lineiter_next(li))<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*c;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ignore<sp/>comments.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(li-&gt;buf[0]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;#&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>the<sp/>first<sp/>space.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>=<sp/>strchr(li-&gt;buf,<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>NULL)<sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Check<sp/>that<sp/>the<sp/>first<sp/>field<sp/>equals<sp/>param<sp/>and<sp/>that<sp/>there&apos;s<sp/>a<sp/>number<sp/>after<sp/>it.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncmp(li-&gt;buf,<sp/>param,<sp/>strlen(param))<sp/>==<sp/>0</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>sscanf(c<sp/>+<sp/>1,<sp/></highlight><highlight class="stringliteral">&quot;%d&quot;</highlight><highlight class="normal">,<sp/>&amp;n)<sp/>==<sp/>1)</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="395"><highlight class="normal">}</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Mark<sp/>every<sp/>node<sp/>that<sp/>has<sp/>a<sp/>path<sp/>to<sp/>the<sp/>argument<sp/>dagnode<sp/>as<sp/>&quot;reachable&quot;.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal">dag_mark_reachable(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*<sp/>d)</highlight></codeline>
<codeline lineno="400"><highlight class="normal">{</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*l;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;next)</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>&amp;&amp;<sp/>!l-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref>)</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag_mark_reachable(l-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>);</highlight></codeline>
<codeline lineno="407"><highlight class="normal">}</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*</highlight></codeline>
<codeline lineno="410" refid="ps__lattice_8c_1aaf4a101f324943c7635746ec6ba7ab06" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1aaf4a101f324943c7635746ec6ba7ab06" kindref="member">ps_lattice_read</ref>(<ref refid="structps__decoder__s" kindref="compound">ps_decoder_t</ref><sp/>*ps,</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*file)</highlight></codeline>
<codeline lineno="412"><highlight class="normal">{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>FILE<sp/>*fp;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>ispipe;</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/>lineiter_t<sp/>*line;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/>float64<sp/>lb;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/>float32<sp/>logratio;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*tail;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>**darray;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>k,<sp/>n_nodes;</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>pip,<sp/>silpen,<sp/>fillpen;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>dag<sp/>=<sp/>ckd_calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*dag));</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ps)<sp/>{</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref><sp/>=<sp/>ps-&gt;<ref refid="structps__decoder__s_1ad337270efc93613cf8dd7594f6515799" kindref="member">search</ref>;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref><sp/>=<sp/><ref refid="dict_8h_1a0edf70be186e8940af9d21243083cb8b" kindref="member">dict_retain</ref>(ps-&gt;<ref refid="structps__decoder__s_1aef6228c17907cc1d0cef835b238b5d91" kindref="member">dict</ref>);</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref><sp/>=<sp/>logmath_retain(ps-&gt;<ref refid="structps__decoder__s_1abd17fe329f2fb219c5a534f3217c5b95" kindref="member">lmath</ref>);</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" kindref="member">frate</ref><sp/>=<sp/>cmd_ln_int32_r(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>-&gt;<ref refid="structps__search__s_1aa6e3e18165bbc70084a06575d5703042" kindref="member">config</ref>,<sp/></highlight><highlight class="stringliteral">&quot;-frate&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref><sp/>=<sp/><ref refid="dict_8h_1a05d8dac3e5fe5399ccb8bf7776e203e2" kindref="member">dict_init</ref>(NULL,<sp/>NULL);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref><sp/>=<sp/>logmath_init(1.0001,<sp/>0,<sp/>FALSE);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" kindref="member">frate</ref><sp/>=<sp/>100;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1acd3f3ab2649f649ba33bf2a422cf12b8" kindref="member">silence</ref><sp/>=<sp/>dict_silwid(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>);</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" kindref="member">latnode_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref>));</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref>));</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref>));</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" kindref="member">refcount</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/>tail<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/>darray<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/>E_INFO(</highlight><highlight class="stringliteral">&quot;Reading<sp/>DAG<sp/>file:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((fp<sp/>=<sp/>fopen_compchk(file,<sp/>&amp;ispipe))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR_SYSTEM(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>open<sp/>DAG<sp/>file<sp/>&apos;%s&apos;<sp/>for<sp/>reading&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/>line<sp/>=<sp/>lineiter_start(fp);</highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>and<sp/>verify<sp/>logbase<sp/>(ONE<sp/>BIG<sp/>HACK!!)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Premature<sp/>EOF(%s)\n&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncmp(line-&gt;buf,<sp/></highlight><highlight class="stringliteral">&quot;#<sp/>getcwd:<sp/>&quot;</highlight><highlight class="normal">,<sp/>10)<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;%s<sp/>does<sp/>not<sp/>begin<sp/>with<sp/>&apos;#<sp/>getcwd:<sp/>&apos;\n%s&quot;</highlight><highlight class="normal">,<sp/>file,<sp/>line-&gt;buf);</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((line<sp/>=<sp/>lineiter_next(line))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Premature<sp/>EOF(%s)\n&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((strncmp(line-&gt;buf,<sp/></highlight><highlight class="stringliteral">&quot;#<sp/>-logbase<sp/>&quot;</highlight><highlight class="normal">,<sp/>11)<sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(sscanf(line-&gt;buf<sp/>+<sp/>11,<sp/></highlight><highlight class="stringliteral">&quot;%lf&quot;</highlight><highlight class="normal">,<sp/>&amp;lb)<sp/>!=<sp/>1))<sp/>{</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_WARN(</highlight><highlight class="stringliteral">&quot;%s:<sp/>Cannot<sp/>find<sp/>-logbase<sp/>in<sp/>header\n&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lb<sp/>=<sp/>1.0001;</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>logratio<sp/>=<sp/>1.0f;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref><sp/>=<sp/>logmath_init(lb,<sp/>0,<sp/>TRUE);</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float32<sp/>pb<sp/>=<sp/>logmath_get_base(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>);</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fabs(lb<sp/>-<sp/>pb)<sp/>&gt;=<sp/>0.0001)<sp/>{</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_WARN(</highlight><highlight class="stringliteral">&quot;Inconsistent<sp/>logbases:<sp/>%f<sp/>vs<sp/>%f:<sp/>will<sp/>compensate\n&quot;</highlight><highlight class="normal">,<sp/>lb,<sp/>pb);</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logratio<sp/>=<sp/>(float32)(log(lb)<sp/>/<sp/>log(pb));</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_INFO(</highlight><highlight class="stringliteral">&quot;Lattice<sp/>log<sp/>ratio:<sp/>%f\n&quot;</highlight><highlight class="normal">,<sp/>logratio);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>Frames<sp/>parameter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" kindref="member">n_frames</ref><sp/>=<sp/>dag_param_read(line,<sp/></highlight><highlight class="stringliteral">&quot;Frames&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" kindref="member">n_frames</ref><sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Frames<sp/>parameter<sp/>missing<sp/>or<sp/>invalid\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>Nodes<sp/>parameter<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/>n_nodes<sp/>=<sp/>dag_param_read(line,<sp/></highlight><highlight class="stringliteral">&quot;Nodes&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n_nodes<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Nodes<sp/>parameter<sp/>missing<sp/>or<sp/>invalid\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>nodes<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/>darray<sp/>=<sp/>ckd_calloc(n_nodes,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*darray));</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n_nodes;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*d;</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>w;</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>seqid,<sp/>sf,<sp/>fef,<sp/>lef;</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>wd[256];</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((line<sp/>=<sp/>lineiter_next(line))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Premature<sp/>EOF<sp/>while<sp/>loading<sp/>Nodes(%s)\n&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="507"><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((k<sp/>=</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sscanf(line-&gt;buf,<sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>%255s<sp/>%d<sp/>%d<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>&amp;seqid,<sp/>wd,<sp/>&amp;sf,<sp/>&amp;fef,</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;lef))<sp/>!=<sp/>5)<sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Cannot<sp/>parse<sp/>line:<sp/>%s,<sp/>value<sp/>of<sp/>count<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>line-&gt;buf,<sp/>k);</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="514"><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="dict_8h_1ad3729eb1a02a9a321e17933f7e90c80e" kindref="member">dict_wordid</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>wd);</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref><sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*ww<sp/>=<sp/>ckd_salloc(wd);</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1a3a128531ae9c077be9882119ed05fe3a" kindref="member">dict_word2basestr</ref>(ww)<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad3729eb1a02a9a321e17933f7e90c80e" kindref="member">dict_wordid</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>ww)<sp/>==<sp/><ref refid="s3types_8h_1a5c42410b7125da611210c5a4be29898b" kindref="member">BAD_S3WID</ref>)</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dict_8h_1a24888ac8e24259e553c43c4655b38432" kindref="member">dict_add_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>ww,<sp/>NULL,<sp/>0);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ckd_free(ww);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w<sp/>=<sp/><ref refid="dict_8h_1a24888ac8e24259e553c43c4655b38432" kindref="member">dict_add_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>wd,<sp/>NULL,<sp/>0);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(w<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Unknown<sp/>word<sp/>in<sp/>line:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>line-&gt;buf);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seqid<sp/>!=<sp/>i)<sp/>{</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Seqno<sp/>error:<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>line-&gt;buf);</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>=<sp/>listelem_malloc(dag-&gt;<ref refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" kindref="member">latnode_alloc</ref>);</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>darray[i]<sp/>=<sp/>d;</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref><sp/>=<sp/>w;</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref><sp/>=<sp/>dict_basewid(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>w);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a78243b37753f7a209c15d6adf98ee3f7" kindref="member">id</ref><sp/>=<sp/>seqid;</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref><sp/>=<sp/>sf;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" kindref="member">fef</ref><sp/>=<sp/>fef;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" kindref="member">lef</ref><sp/>=<sp/>lef;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref><sp/>=<sp/>d-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>)</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref><sp/>=<sp/>d;</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tail-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref><sp/>=<sp/>d;</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tail<sp/>=<sp/>d;</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="555"><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>initial<sp/>node<sp/>ID<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>k<sp/>=<sp/>dag_param_read(line,<sp/></highlight><highlight class="stringliteral">&quot;Initial&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((k<sp/>&lt;<sp/>0)<sp/>||<sp/>(k<sp/>&gt;=<sp/>n_nodes))<sp/>{</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Initial<sp/>node<sp/>parameter<sp/>missing<sp/>or<sp/>invalid\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref><sp/>=<sp/>darray[k];</highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>final<sp/>node<sp/>ID<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>k<sp/>=<sp/>dag_param_read(line,<sp/></highlight><highlight class="stringliteral">&quot;Final&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((k<sp/>&lt;<sp/>0)<sp/>||<sp/>(k<sp/>&gt;=<sp/>n_nodes))<sp/>{</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Final<sp/>node<sp/>parameter<sp/>missing<sp/>or<sp/>invalid\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref><sp/>=<sp/>darray[k];</highlight></codeline>
<codeline lineno="571"><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>bestsegscore<sp/>entries<sp/>and<sp/>ignore<sp/>them.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((k<sp/>=<sp/>dag_param_read(line,<sp/></highlight><highlight class="stringliteral">&quot;BestSegAscr&quot;</highlight><highlight class="normal">))<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;BestSegAscr<sp/>parameter<sp/>missing\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>k;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((line<sp/>=<sp/>lineiter_next(line))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Premature<sp/>EOF<sp/>while<sp/>(%s)<sp/>ignoring<sp/>BestSegAscr\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>in<sp/>edges.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((line<sp/>=<sp/>lineiter_next(line))<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line-&gt;buf[0]<sp/>==<sp/></highlight><highlight class="charliteral">&apos;#&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(0<sp/>==<sp/>strncmp(line-&gt;buf,<sp/></highlight><highlight class="stringliteral">&quot;Edges&quot;</highlight><highlight class="normal">,<sp/>5))</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Edges<sp/>missing\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((line<sp/>=<sp/>lineiter_next(line))<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>from,<sp/>to,<sp/>ascr;</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*pd,<sp/>*d;</highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sscanf(line-&gt;buf,<sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>%d<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>&amp;from,<sp/>&amp;to,<sp/>&amp;ascr)<sp/>!=<sp/>3)</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ascr<sp/><ref refid="hmm_8h_1aa930fb8fb6fce7f34bcf4018b81d7066" kindref="member">WORSE_THAN</ref><sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref>)</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pd<sp/>=<sp/>darray[from];</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d<sp/>=<sp/>darray[to];</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(logratio<sp/>!=<sp/>1.0f)</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ascr<sp/>=<sp/>(int32)(ascr<sp/>*<sp/>logratio);</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a4dd3235b91f1c7202127893203c6d2a0" kindref="member">ps_lattice_link</ref>(dag,<sp/>pd,<sp/>d,<sp/>ascr,<sp/>d-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref><sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(line-&gt;buf,<sp/></highlight><highlight class="stringliteral">&quot;End\n&quot;</highlight><highlight class="normal">)<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Terminating<sp/>&apos;End&apos;<sp/>missing\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">goto</highlight><highlight class="normal"><sp/>load_error;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/>lineiter_free(line);</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/>fclose_comp(fp,<sp/>ispipe);</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(darray);</highlight></codeline>
<codeline lineno="617"><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Minor<sp/>hack:<sp/>If<sp/>the<sp/>final<sp/>node<sp/>is<sp/>a<sp/>filler<sp/>word<sp/>and<sp/>not<sp/>&lt;/s&gt;,</highlight></codeline>
<codeline lineno="619"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>then<sp/>set<sp/>its<sp/>base<sp/>word<sp/>ID<sp/>to<sp/>&lt;/s&gt;,<sp/>so<sp/>that<sp/>the<sp/>language<sp/>model</highlight></codeline>
<codeline lineno="620"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>scores<sp/>won&apos;t<sp/>be<sp/>screwed<sp/>up.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>))</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref></highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/>ps_search_finish_wid(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>)</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="dict_8h_1ad3729eb1a02a9a321e17933f7e90c80e" kindref="member">dict_wordid</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>S3_FINISH_WORD);</highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Mark<sp/>reachable<sp/>from<sp/>dag-&gt;end<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/>dag_mark_reachable(dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>);</highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Free<sp/>nodes<sp/>unreachable<sp/>from<sp/>dag-&gt;end<sp/>and<sp/>their<sp/>links<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a6da4e36322aaab4d2ebe812bee9a4439" kindref="member">ps_lattice_delete_unreachable</ref>(dag);</highlight></codeline>
<codeline lineno="631"><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ps)<sp/>{</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Build<sp/>links<sp/>around<sp/>silence<sp/>and<sp/>filler<sp/>words,<sp/>since<sp/>they<sp/>do</highlight></codeline>
<codeline lineno="634"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>not<sp/>exist<sp/>in<sp/>the<sp/>language<sp/>model.<sp/><sp/>FIXME:<sp/>This<sp/>is</highlight></codeline>
<codeline lineno="635"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>potentially<sp/>buggy,<sp/>as<sp/>we<sp/>already<sp/>do<sp/>this<sp/>before<sp/>outputing</highlight></codeline>
<codeline lineno="636"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>lattices.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pip<sp/>=<sp/>logmath_log(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>,<sp/>cmd_ln_float32_r(ps-&gt;<ref refid="structps__decoder__s_1a0565ed97b32408bd05c8104f020cef05" kindref="member">config</ref>,<sp/></highlight><highlight class="stringliteral">&quot;-pip&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>silpen<sp/>=<sp/>pip<sp/>+<sp/>logmath_log(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>,</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cmd_ln_float32_r(ps-&gt;<ref refid="structps__decoder__s_1a0565ed97b32408bd05c8104f020cef05" kindref="member">config</ref>,<sp/></highlight><highlight class="stringliteral">&quot;-silprob&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fillpen<sp/>=<sp/>pip<sp/>+<sp/>logmath_log(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>,</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cmd_ln_float32_r(ps-&gt;<ref refid="structps__decoder__s_1a0565ed97b32408bd05c8104f020cef05" kindref="member">config</ref>,<sp/></highlight><highlight class="stringliteral">&quot;-fillprob&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a9b40adaa059978fe33959d59da1b6919" kindref="member">ps_lattice_bypass_fillers</ref>(dag,<sp/>silpen,<sp/>fillpen);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag;</highlight></codeline>
<codeline lineno="646"><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/>load_error:</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/>E_ERROR(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>load<sp/>%s\n&quot;</highlight><highlight class="normal">,<sp/>file);</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>lineiter_free(line);</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(fp)<sp/>fclose_comp(fp,<sp/>ispipe);</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(darray);</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="653"><highlight class="normal">}</highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656" refid="ps__lattice_8c_1a60b5a6a96a68e9b778dbef2156d859c8" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a60b5a6a96a68e9b778dbef2156d859c8" kindref="member">ps_lattice_n_frames</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="657"><highlight class="normal">{</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag-&gt;<ref refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" kindref="member">n_frames</ref>;</highlight></codeline>
<codeline lineno="659"><highlight class="normal">}</highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"><ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*</highlight></codeline>
<codeline lineno="662" refid="ps__lattice__internal_8h_1a606f6ee0fd569dd5829d7f84ae7e61bd" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a606f6ee0fd569dd5829d7f84ae7e61bd" kindref="member">ps_lattice_init_search</ref>(<ref refid="structps__search__s" kindref="compound">ps_search_t</ref><sp/>*search,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n_frame)</highlight></codeline>
<codeline lineno="663"><highlight class="normal">{</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag;</highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/>dag<sp/>=<sp/>ckd_calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*dag));</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref><sp/>=<sp/>search;</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref><sp/>=<sp/><ref refid="dict_8h_1a0edf70be186e8940af9d21243083cb8b" kindref="member">dict_retain</ref>(search-&gt;<ref refid="structps__search__s_1a918f243fa966e72c47f697fb9e60089d" kindref="member">dict</ref>);</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref><sp/>=<sp/>logmath_retain(search-&gt;<ref refid="structps__search__s_1a0fdf6fe8c4d9c28f10c48c09517c6b91" kindref="member">acmod</ref>-&gt;<ref refid="structacmod__s_1a9de7e8ac9c0c4df3d2a9ad5406787f3c" kindref="member">lmath</ref>);</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5159a2ff1e03a7c9782854bc67e56530" kindref="member">frate</ref><sp/>=<sp/>cmd_ln_int32_r(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>-&gt;<ref refid="structps__search__s_1aa6e3e18165bbc70084a06575d5703042" kindref="member">config</ref>,<sp/></highlight><highlight class="stringliteral">&quot;-frate&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1acd3f3ab2649f649ba33bf2a422cf12b8" kindref="member">silence</ref><sp/>=<sp/>dict_silwid(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>);</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" kindref="member">n_frames</ref><sp/>=<sp/>n_frame;</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" kindref="member">latnode_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref>));</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref>));</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref>));</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" kindref="member">refcount</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag;</highlight></codeline>
<codeline lineno="678"><highlight class="normal">}</highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*</highlight></codeline>
<codeline lineno="681" refid="ps__lattice_8c_1af8a33c587f5b7a6f5b8c86e6068dc297" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1af8a33c587f5b7a6f5b8c86e6068dc297" kindref="member">ps_lattice_retain</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="682"><highlight class="normal">{</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/>++dag-&gt;<ref refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" kindref="member">refcount</ref>;</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag;</highlight></codeline>
<codeline lineno="685"><highlight class="normal">}</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="688" refid="ps__lattice_8c_1aed9371a246b6565a2142c3baefd08002" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1aed9371a246b6565a2142c3baefd08002" kindref="member">ps_lattice_free</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="689"><highlight class="normal">{</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(--dag-&gt;<ref refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" kindref="member">refcount</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag-&gt;<ref refid="structps__lattice__s_1a6d66b392dec016b3304da2f53be17dd1" kindref="member">refcount</ref>;</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/>logmath_free(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>);</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dict_8h_1a51ee6c067decce8dbc182f95f7b33e91" kindref="member">dict_free</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/>listelem_alloc_free(dag-&gt;<ref refid="structps__lattice__s_1a14e4e87550647d5119cd1cc48ff4f3f1" kindref="member">latnode_alloc</ref>);</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/>listelem_alloc_free(dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref>);</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/>listelem_alloc_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>);<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref>);</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(dag);</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="702"><highlight class="normal">}</highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal">logmath_t<sp/>*</highlight></codeline>
<codeline lineno="705" refid="ps__lattice_8c_1a4a952a1cb88b833989fb39476da5fe1b" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a4a952a1cb88b833989fb39476da5fe1b" kindref="member">ps_lattice_get_logmath</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="706"><highlight class="normal">{</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>;</highlight></codeline>
<codeline lineno="708"><highlight class="normal">}</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><ref refid="structps__latnode__s" kindref="compound">ps_latnode_iter_t</ref><sp/>*</highlight></codeline>
<codeline lineno="711" refid="ps__lattice_8c_1a607bfd65847baff33f404936c1543d16" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a607bfd65847baff33f404936c1543d16" kindref="member">ps_latnode_iter</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="712"><highlight class="normal">{</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;</highlight></codeline>
<codeline lineno="714"><highlight class="normal">}</highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight></codeline>
<codeline lineno="716"><highlight class="normal"><ref refid="structps__latnode__s" kindref="compound">ps_latnode_iter_t</ref><sp/>*</highlight></codeline>
<codeline lineno="717" refid="ps__lattice_8c_1a77c4bbb13e260c72ed04ad93b02fdf0e" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a77c4bbb13e260c72ed04ad93b02fdf0e" kindref="member">ps_latnode_iter_next</ref>(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_iter_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="718"><highlight class="normal">{</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>itor-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="720"><highlight class="normal">}</highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="723" refid="ps__lattice_8c_1ae1d64649785989033826329b9fcce309" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1ae1d64649785989033826329b9fcce309" kindref="member">ps_latnode_iter_free</ref>(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_iter_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="724"><highlight class="normal">{</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Do<sp/>absolutely<sp/>nothing.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal">}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*</highlight></codeline>
<codeline lineno="729" refid="ps__lattice_8c_1a990f488a747f95bc94777a755401710d" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a990f488a747f95bc94777a755401710d" kindref="member">ps_latnode_iter_node</ref>(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_iter_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="730"><highlight class="normal">{</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>itor;</highlight></codeline>
<codeline lineno="732"><highlight class="normal">}</highlight></codeline>
<codeline lineno="733"><highlight class="normal"></highlight></codeline>
<codeline lineno="734"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="735" refid="ps__lattice_8c_1a89b67432447f693f787ec14460cfa2a4" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a89b67432447f693f787ec14460cfa2a4" kindref="member">ps_latnode_times</ref>(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node,<sp/>int16<sp/>*out_fef,<sp/>int16<sp/>*out_lef)</highlight></codeline>
<codeline lineno="736"><highlight class="normal">{</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(out_fef)<sp/>*out_fef<sp/>=<sp/>(int16)node-&gt;<ref refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" kindref="member">fef</ref>;</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(out_lef)<sp/>*out_lef<sp/>=<sp/>(int16)node-&gt;<ref refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" kindref="member">lef</ref>;</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>node-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>;</highlight></codeline>
<codeline lineno="740"><highlight class="normal">}</highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="743" refid="ps__lattice_8c_1a5827c1004a64e7e6c5208928c28d403d" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a5827c1004a64e7e6c5208928c28d403d" kindref="member">ps_latnode_word</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node)</highlight></codeline>
<codeline lineno="744"><highlight class="normal">{</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>node-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>);</highlight></codeline>
<codeline lineno="746"><highlight class="normal">}</highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="749" refid="ps__lattice_8c_1a42212e56eb6e881a0ceb1b8ad029427a" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a42212e56eb6e881a0ceb1b8ad029427a" kindref="member">ps_latnode_baseword</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node)</highlight></codeline>
<codeline lineno="750"><highlight class="normal">{</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>node-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="752"><highlight class="normal">}</highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight></codeline>
<codeline lineno="754"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="755" refid="ps__lattice_8c_1ad9c31352fa8e6286b1221221208075e9" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1ad9c31352fa8e6286b1221221208075e9" kindref="member">ps_latnode_prob</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node,</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>**out_link)</highlight></codeline>
<codeline lineno="757"><highlight class="normal">{</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*links;</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>bestpost<sp/>=<sp/>logmath_get_zero(dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>);</highlight></codeline>
<codeline lineno="760"><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(links<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>links;<sp/>links<sp/>=<sp/>links-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>post<sp/>=<sp/>links-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>links-&gt;link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>-<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>;</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(post<sp/>&gt;<sp/>bestpost)<sp/>{</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(out_link)<sp/>*out_link<sp/>=<sp/>links-&gt;link;</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestpost<sp/>=<sp/>post;</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bestpost;</highlight></codeline>
<codeline lineno="769"><highlight class="normal">}</highlight></codeline>
<codeline lineno="770"><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"><ref refid="structlatlink__list__s" kindref="compound">ps_latlink_iter_t</ref><sp/>*</highlight></codeline>
<codeline lineno="772" refid="ps__lattice_8c_1a6169f8a8d8b7f84596438e5bb3095bc6" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a6169f8a8d8b7f84596438e5bb3095bc6" kindref="member">ps_latnode_exits</ref>(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node)</highlight></codeline>
<codeline lineno="773"><highlight class="normal">{</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;</highlight></codeline>
<codeline lineno="775"><highlight class="normal">}</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><ref refid="structlatlink__list__s" kindref="compound">ps_latlink_iter_t</ref><sp/>*</highlight></codeline>
<codeline lineno="778" refid="ps__lattice_8c_1a36f3fa1635d251b908c553153f614e22" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a36f3fa1635d251b908c553153f614e22" kindref="member">ps_latnode_entries</ref>(<ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node)</highlight></codeline>
<codeline lineno="779"><highlight class="normal">{</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>node-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;</highlight></codeline>
<codeline lineno="781"><highlight class="normal">}</highlight></codeline>
<codeline lineno="782"><highlight class="normal"></highlight></codeline>
<codeline lineno="783"><highlight class="normal"><ref refid="structlatlink__list__s" kindref="compound">ps_latlink_iter_t</ref><sp/>*</highlight></codeline>
<codeline lineno="784" refid="ps__lattice_8c_1a6caee73548f9a6c17626e959256d721c" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a6caee73548f9a6c17626e959256d721c" kindref="member">ps_latlink_iter_next</ref>(<ref refid="structlatlink__list__s" kindref="compound">ps_latlink_iter_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="785"><highlight class="normal">{</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>itor-&gt;next;</highlight></codeline>
<codeline lineno="787"><highlight class="normal">}</highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="790" refid="ps__lattice_8c_1aab5953eafb2e632307259a7fc40c01e3" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1aab5953eafb2e632307259a7fc40c01e3" kindref="member">ps_latlink_iter_free</ref>(<ref refid="structlatlink__list__s" kindref="compound">ps_latlink_iter_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="791"><highlight class="normal">{</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Do<sp/>absolutely<sp/>nothing.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal">}</highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="796" refid="ps__lattice_8c_1a33a6c95621d4c8980a8c6b0f8af3bc67" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a33a6c95621d4c8980a8c6b0f8af3bc67" kindref="member">ps_latlink_iter_link</ref>(<ref refid="structlatlink__list__s" kindref="compound">ps_latlink_iter_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="797"><highlight class="normal">{</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>itor-&gt;link;</highlight></codeline>
<codeline lineno="799"><highlight class="normal">}</highlight></codeline>
<codeline lineno="800"><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="802" refid="ps__lattice_8c_1afc4403b067467f3c74c97998f1c91886" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1afc4403b067467f3c74c97998f1c91886" kindref="member">ps_latlink_times</ref>(<ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/>int16<sp/>*out_sf)</highlight></codeline>
<codeline lineno="803"><highlight class="normal">{</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(out_sf)<sp/>{</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>)<sp/>{</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*out_sf<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>;</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*out_sf<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>link-&gt;<ref refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" kindref="member">ef</ref>;</highlight></codeline>
<codeline lineno="813"><highlight class="normal">}</highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*</highlight></codeline>
<codeline lineno="816" refid="ps__lattice_8c_1a891d9c5aa6a5cbe8631812fbd6e87e25" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a891d9c5aa6a5cbe8631812fbd6e87e25" kindref="member">ps_latlink_nodes</ref>(<ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>**out_src)</highlight></codeline>
<codeline lineno="817"><highlight class="normal">{</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(out_src)<sp/>*out_src<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>;</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>;</highlight></codeline>
<codeline lineno="820"><highlight class="normal">}</highlight></codeline>
<codeline lineno="821"><highlight class="normal"></highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="823" refid="ps__lattice_8c_1a3c765dfc290549e8f27e619269d20e5a" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a3c765dfc290549e8f27e619269d20e5a" kindref="member">ps_latlink_word</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link)</highlight></codeline>
<codeline lineno="824"><highlight class="normal">{</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>);</highlight></codeline>
<codeline lineno="828"><highlight class="normal">}</highlight></codeline>
<codeline lineno="829"><highlight class="normal"></highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="831" refid="ps__lattice_8c_1a1f8f4dba5bbcf9056c5bd3e97e39839d" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a1f8f4dba5bbcf9056c5bd3e97e39839d" kindref="member">ps_latlink_baseword</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link)</highlight></codeline>
<codeline lineno="832"><highlight class="normal">{</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="836"><highlight class="normal">}</highlight></codeline>
<codeline lineno="837"><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="839" refid="ps__lattice_8c_1a6ea04952718752806ad92773c98ac33d" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a6ea04952718752806ad92773c98ac33d" kindref="member">ps_latlink_pred</ref>(<ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link)</highlight></codeline>
<codeline lineno="840"><highlight class="normal">{</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>link-&gt;best_prev;</highlight></codeline>
<codeline lineno="842"><highlight class="normal">}</highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="845" refid="ps__lattice_8c_1a7025b47d1224f01fef725ffdae71becc" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a7025b47d1224f01fef725ffdae71becc" kindref="member">ps_latlink_prob</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/>int32<sp/>*out_ascr)</highlight></codeline>
<codeline lineno="846"><highlight class="normal">{</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>post<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>-<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>;</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(out_ascr)<sp/>*out_ascr<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>post;</highlight></codeline>
<codeline lineno="850"><highlight class="normal">}</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="853" refid="ps__lattice__internal_8h_1a02b07c009d23b852bd4db54700dfac5b" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a02b07c009d23b852bd4db54700dfac5b" kindref="member">ps_lattice_hyp</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link)</highlight></codeline>
<codeline lineno="854"><highlight class="normal">{</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*l;</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*c;</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Backtrace<sp/>once<sp/>to<sp/>get<sp/>hypothesis<sp/>length.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>There<sp/>may<sp/>not<sp/>be<sp/>a<sp/>search,<sp/>but<sp/>actually<sp/>there<sp/>should<sp/>be<sp/>a<sp/>dict.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" kindref="member">dict_real_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wstr<sp/>=<sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wstr<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>+=<sp/>strlen(wstr)<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>link;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;best_prev)<sp/>{</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" kindref="member">dict_real_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>l-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wstr<sp/>=<sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>l-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wstr<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>+=<sp/>strlen(wstr)<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="874"><highlight class="normal"></highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Backtrace<sp/>again<sp/>to<sp/>construct<sp/>hypothesis<sp/>string.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref>);</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref><sp/>=<sp/>ckd_calloc(1,<sp/>len+1);<sp/></highlight><highlight class="comment">/*<sp/>extra<sp/>one<sp/>incase<sp/>the<sp/>hyp<sp/>is<sp/>empty<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/>c<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref><sp/>+<sp/>len<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" kindref="member">dict_real_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wstr<sp/>=<sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wstr<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(wstr);</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>-=<sp/>len;</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(c,<sp/>wstr,<sp/>len);</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;<sp/>dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref>)<sp/>{</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--c;</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>link;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;best_prev)<sp/>{</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" kindref="member">dict_real_word</ref>(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>l-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wstr<sp/>=<sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a71865c59fae65743ef3c6b5aceb17da6" kindref="member">dict</ref>,<sp/>l-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wstr<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(wstr);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>-=<sp/>len;</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(c,<sp/>wstr,<sp/>len);</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;<sp/>dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref>)<sp/>{</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--c;</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="905"><highlight class="normal"></highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dag-&gt;<ref refid="structps__lattice__s_1ac3844c69f8393b607047bd9b302b979a" kindref="member">hyp_str</ref>;</highlight></codeline>
<codeline lineno="907"><highlight class="normal">}</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="910"><highlight class="normal">ps_lattice_compute_lscr(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>to)</highlight></codeline>
<codeline lineno="911"><highlight class="normal">{</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/>ngram_model_t<sp/>*lmset;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Language<sp/>model<sp/>score<sp/>is<sp/>included<sp/>in<sp/>the<sp/>link<sp/>score<sp/>for<sp/>FSG</highlight></codeline>
<codeline lineno="915"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>search.<sp/><sp/>FIXME:<sp/>Of<sp/>course,<sp/>this<sp/>is<sp/>sort<sp/>of<sp/>a<sp/>hack<sp/>:(<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(0<sp/>!=<sp/>strcmp(ps_search_name(seg-&gt;<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref>),<sp/>PS_SEARCH_NGRAM))<sp/>{</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a4d86c21f1ed2dc3eb3b1b1b37ce9bb48" kindref="member">lback</ref><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">/*<sp/>Unigram...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a69e605f422eeed1a9c67437e8ddd8b08" kindref="member">lscr</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/>lmset<sp/>=<sp/>((<ref refid="structngram__search__s" kindref="compound">ngram_search_t</ref><sp/>*)seg-&gt;<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref>)-&gt;lmset;</highlight></codeline>
<codeline lineno="923"><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;best_prev<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(to)<sp/></highlight><highlight class="comment">/*<sp/>Sentence<sp/>has<sp/>only<sp/>two<sp/>words.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a69e605f422eeed1a9c67437e8ddd8b08" kindref="member">lscr</ref><sp/>=<sp/>ngram_bg_score(lmset,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>&amp;seg-&gt;<ref refid="structps__seg__s_1a4d86c21f1ed2dc3eb3b1b1b37ce9bb48" kindref="member">lback</ref>)</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight><highlight class="comment">/*<sp/>This<sp/>is<sp/>the<sp/>start<sp/>symbol,<sp/>its<sp/>lscr<sp/>is<sp/>always<sp/>0.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a69e605f422eeed1a9c67437e8ddd8b08" kindref="member">lscr</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a4d86c21f1ed2dc3eb3b1b1b37ce9bb48" kindref="member">lback</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>the<sp/>two<sp/>predecessor<sp/>words.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(to)<sp/>{</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a69e605f422eeed1a9c67437e8ddd8b08" kindref="member">lscr</ref><sp/>=<sp/>ngram_tg_score(lmset,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;best_prev-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;seg-&gt;<ref refid="structps__seg__s_1a4d86c21f1ed2dc3eb3b1b1b37ce9bb48" kindref="member">lback</ref>)<sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;best_prev-&gt;best_prev)</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a69e605f422eeed1a9c67437e8ddd8b08" kindref="member">lscr</ref><sp/>=<sp/>ngram_tg_score(lmset,<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;best_prev-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;best_prev-&gt;best_prev-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;seg-&gt;<ref refid="structps__seg__s_1a4d86c21f1ed2dc3eb3b1b1b37ce9bb48" kindref="member">lback</ref>)<sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a69e605f422eeed1a9c67437e8ddd8b08" kindref="member">lscr</ref><sp/>=<sp/>ngram_bg_score(lmset,<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;best_prev-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;seg-&gt;<ref refid="structps__seg__s_1a4d86c21f1ed2dc3eb3b1b1b37ce9bb48" kindref="member">lback</ref>)<sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="954"><highlight class="normal">}</highlight></codeline>
<codeline lineno="955"><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal">ps_lattice_link2itor(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>to)</highlight></codeline>
<codeline lineno="958"><highlight class="normal">{</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*itor<sp/>=<sp/>(<ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*)seg;</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="961"><highlight class="normal"></highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(to)<sp/>{</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>;</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ab25ecc6af8d2695c6097cf7e934eadd4" kindref="member">ef</ref><sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" kindref="member">lef</ref>;</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ae683244d90d0a5339930b47757778432" kindref="member">prob</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>norm<sp/>+<sp/>beta<sp/>-<sp/>norm<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*n;</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logmath_t<sp/>*lmath<sp/>=<sp/>ps_search_acmod(seg-&gt;<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref>)-&gt;lmath;</highlight></codeline>
<codeline lineno="971"><highlight class="normal"></highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>;</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ab25ecc6af8d2695c6097cf7e934eadd4" kindref="member">ef</ref><sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a59e2bf9a1c0dd6ce4ac76a17c58fbe36" kindref="member">ef</ref>;</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ae683244d90d0a5339930b47757778432" kindref="member">prob</ref><sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>-<sp/>itor-&gt;<ref refid="structdag__seg__s_1a4517656eeaa40d33109d39a251a75dea" kindref="member">norm</ref>;</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sum<sp/>over<sp/>all<sp/>exits<sp/>for<sp/>this<sp/>word<sp/>and<sp/>any<sp/>alternate</highlight></codeline>
<codeline lineno="976"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pronunciations<sp/>at<sp/>the<sp/>same<sp/>frame.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n<sp/>=<sp/>node;<sp/>n;<sp/>n<sp/>=<sp/>n-&gt;<ref refid="structps__latnode__s_1aa4c0a395c74acbacccde561f92fa89e4" kindref="member">alt</ref>)<sp/>{</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>n-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link<sp/>==<sp/>link)</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ae683244d90d0a5339930b47757778432" kindref="member">prob</ref><sp/>=<sp/>logmath_add(lmath,<sp/>seg-&gt;<ref refid="structps__seg__s_1ae683244d90d0a5339930b47757778432" kindref="member">prob</ref>,</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>-<sp/>itor-&gt;<ref refid="structdag__seg__s_1a4517656eeaa40d33109d39a251a75dea" kindref="member">norm</ref>);</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a97a0dc7db931c7e3f98d23d21ce27f04" kindref="member">word</ref><sp/>=<sp/>dict_wordstr(ps_search_dict(seg-&gt;<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref>),<sp/>node-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>);</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a885a599726cd0efba573d106d016e6e2" kindref="member">sf</ref><sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>;</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a6f7706ec4c0d0ec8ecafaf0f29f41f4b" kindref="member">ascr</ref><sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Compute<sp/>language<sp/>model<sp/>score<sp/>from<sp/>best<sp/>predecessors.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/>ps_lattice_compute_lscr(seg,<sp/>link,<sp/>to);</highlight></codeline>
<codeline lineno="991"><highlight class="normal">}</highlight></codeline>
<codeline lineno="992"><highlight class="normal"></highlight></codeline>
<codeline lineno="993"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="994"><highlight class="normal">ps_lattice_seg_free(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg)</highlight></codeline>
<codeline lineno="995"><highlight class="normal">{</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*itor<sp/>=<sp/>(<ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*)seg;</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref>);</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(itor);</highlight></codeline>
<codeline lineno="1000"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1003"><highlight class="normal">ps_lattice_seg_next(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg)</highlight></codeline>
<codeline lineno="1004"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*itor<sp/>=<sp/>(<ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*)seg;</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/>++itor-&gt;<ref refid="structdag__seg__s_1a0fed697e06d12e5a0405fdcb0d97faf1" kindref="member">cur</ref>;</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itor-&gt;<ref refid="structdag__seg__s_1a0fed697e06d12e5a0405fdcb0d97faf1" kindref="member">cur</ref><sp/>==<sp/>itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref><sp/>+<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ps_lattice_seg_free(seg);</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itor-&gt;<ref refid="structdag__seg__s_1a0fed697e06d12e5a0405fdcb0d97faf1" kindref="member">cur</ref><sp/>==<sp/>itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Re-use<sp/>the<sp/>last<sp/>link<sp/>but<sp/>with<sp/>the<sp/>&quot;to&quot;<sp/>node.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ps_lattice_link2itor(seg,<sp/>itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref>[itor-&gt;<ref refid="structdag__seg__s_1a0fed697e06d12e5a0405fdcb0d97faf1" kindref="member">cur</ref><sp/>-<sp/>1],<sp/>TRUE);</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ps_lattice_link2itor(seg,<sp/>itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref>[itor-&gt;<ref refid="structdag__seg__s_1a0fed697e06d12e5a0405fdcb0d97faf1" kindref="member">cur</ref>],<sp/>FALSE);</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>seg;</highlight></codeline>
<codeline lineno="1021"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structps__segfuncs__s" kindref="compound">ps_segfuncs_t</ref><sp/>ps_lattice_segfuncs<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>seg_next<sp/>*/</highlight><highlight class="normal"><sp/>ps_lattice_seg_next,</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>seg_free<sp/>*/</highlight><highlight class="normal"><sp/>ps_lattice_seg_free</highlight></codeline>
<codeline lineno="1026"><highlight class="normal">};</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1029" refid="ps__lattice__internal_8h_1afedbc5558c18f7d029e84a4e27e38187" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1afedbc5558c18f7d029e84a4e27e38187" kindref="member">ps_lattice_seg_iter</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/>float32<sp/>lwf)</highlight></codeline>
<codeline lineno="1030"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structdag__seg__s" kindref="compound">dag_seg_t</ref><sp/>*itor;</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*l;</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cur;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Calling<sp/>this<sp/>an<sp/>&quot;iterator&quot;<sp/>is<sp/>a<sp/>bit<sp/>of<sp/>a<sp/>misnomer<sp/>since<sp/>we<sp/>have</highlight></codeline>
<codeline lineno="1036"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>get<sp/>the<sp/>entire<sp/>backtrace<sp/>in<sp/>order<sp/>to<sp/>produce<sp/>it.</highlight></codeline>
<codeline lineno="1037"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/>itor<sp/>=<sp/>ckd_calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*itor));</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a72f90e137c1f83ab3df6ecd5e1b6dc71" kindref="member">base</ref>.<ref refid="structps__seg__s_1a510362a2281e374c839397c3e5488515" kindref="member">vt</ref><sp/>=<sp/>&amp;ps_lattice_segfuncs;</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a72f90e137c1f83ab3df6ecd5e1b6dc71" kindref="member">base</ref>.<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>;</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a72f90e137c1f83ab3df6ecd5e1b6dc71" kindref="member">base</ref>.<ref refid="structps__seg__s_1a2249c012b83c902f4f8ed8d98ded7d20" kindref="member">lwf</ref><sp/>=<sp/>lwf;</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a4517656eeaa40d33109d39a251a75dea" kindref="member">norm</ref><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>;</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>link;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;best_prev)<sp/>{</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref>;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ckd_free(itor);</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref><sp/>=<sp/>ckd_calloc(itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref>));</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/>cur<sp/>=<sp/>itor-&gt;<ref refid="structdag__seg__s_1a2a858ea6ef051074be2bd1716a4939fb" kindref="member">n_links</ref><sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(l<sp/>=<sp/>link;<sp/>l;<sp/>l<sp/>=<sp/>l-&gt;best_prev)<sp/>{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref>[cur]<sp/>=<sp/>l;</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--cur;</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/>ps_lattice_link2itor((<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*)itor,<sp/>itor-&gt;<ref refid="structdag__seg__s_1a5fcc22d787e4db1bdc728ff8faead738" kindref="member">links</ref>[0],<sp/>FALSE);</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*)itor;</highlight></codeline>
<codeline lineno="1062"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1065" refid="ps__lattice__internal_8h_1a7197508af770064ea825bb812dd6eddc" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a7197508af770064ea825bb812dd6eddc" kindref="member">latlink_list_new</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*next)</highlight></codeline>
<codeline lineno="1066"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*ll;</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"></highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/>ll<sp/>=<sp/>listelem_malloc(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>);</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/>ll-&gt;link<sp/>=<sp/>link;</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/>ll-&gt;next<sp/>=<sp/>next;</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ll;</highlight></codeline>
<codeline lineno="1074"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"></highlight></codeline>
<codeline lineno="1076"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1077" refid="ps__lattice__internal_8h_1a04896ebe0e2592bc7950d413b5d5c52e" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" kindref="member">ps_lattice_pushq</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link)</highlight></codeline>
<codeline lineno="1078"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" kindref="member">q_tail</ref><sp/>=<sp/><ref refid="ps__lattice_8c_1a7197508af770064ea825bb812dd6eddc" kindref="member">latlink_list_new</ref>(dag,<sp/>link,<sp/>NULL);</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" kindref="member">q_tail</ref>-&gt;next<sp/>=<sp/><ref refid="ps__lattice_8c_1a7197508af770064ea825bb812dd6eddc" kindref="member">latlink_list_new</ref>(dag,<sp/>link,<sp/>NULL);</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" kindref="member">q_tail</ref><sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" kindref="member">q_tail</ref>-&gt;next;</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"></highlight></codeline>
<codeline lineno="1086"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"></highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1089" refid="ps__lattice__internal_8h_1a481c4d941368597e11b0af4709bd03b0" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" kindref="member">ps_lattice_popq</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="1090"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link;</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/>link<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref>-&gt;link;</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/>x<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref>-&gt;next;</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref>);</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref><sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a26c029189074db2f668d5a9d67eb7af5" kindref="member">q_head</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a5a9faf5e4aabd84a868d1bff97dd9814" kindref="member">q_tail</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>link;</highlight></codeline>
<codeline lineno="1103"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1106" refid="ps__lattice__internal_8h_1ad128ca75e8bc7ca4ba41094fb5b68ee9" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" kindref="member">ps_lattice_delq</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag)</highlight></codeline>
<codeline lineno="1107"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" kindref="member">ps_lattice_popq</ref>(dag))<sp/>{</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Do<sp/>nothing.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1111"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1114" refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" kindref="member">ps_lattice_traverse_edges</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*start,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*end)</highlight></codeline>
<codeline lineno="1115"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cancel<sp/>any<sp/>unfinished<sp/>traversal.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" kindref="member">ps_lattice_delq</ref>(dag);</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"></highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>node<sp/>fanin<sp/>counts<sp/>and<sp/>path<sp/>scores.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref>)++;</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"></highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>agenda<sp/>with<sp/>all<sp/>exits<sp/>from<sp/>start.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(start<sp/>==<sp/>NULL)<sp/>start<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>;</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>start-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" kindref="member">ps_lattice_pushq</ref>(dag,<sp/>x-&gt;link);</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pull<sp/>the<sp/>first<sp/>edge<sp/>off<sp/>the<sp/>queue.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" kindref="member">ps_lattice_traverse_next</ref>(dag,<sp/>end);</highlight></codeline>
<codeline lineno="1137"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1140" refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" kindref="member">ps_lattice_traverse_next</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*end)</highlight></codeline>
<codeline lineno="1141"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*next;</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"></highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/>next<sp/>=<sp/><ref refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" kindref="member">ps_lattice_popq</ref>(dag);</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Decrease<sp/>fanin<sp/>count<sp/>for<sp/>destination<sp/>node<sp/>and<sp/>expand<sp/>outgoing</highlight></codeline>
<codeline lineno="1149"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>edges<sp/>if<sp/>all<sp/>incoming<sp/>edges<sp/>have<sp/>been<sp/>seen.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/>--next-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref>;</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(end<sp/>==<sp/>NULL)<sp/>end<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>;</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>==<sp/>end)<sp/>{</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>we<sp/>have<sp/>traversed<sp/>all<sp/>links<sp/>entering<sp/>the<sp/>end<sp/>node,</highlight></codeline>
<codeline lineno="1157"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>clear<sp/>the<sp/>queue,<sp/>causing<sp/>future<sp/>calls<sp/>to<sp/>this<sp/>function</highlight></codeline>
<codeline lineno="1158"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>return<sp/>NULL.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" kindref="member">ps_lattice_delq</ref>(dag);</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next;</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extend<sp/>all<sp/>outgoing<sp/>edges.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>next-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" kindref="member">ps_lattice_pushq</ref>(dag,<sp/>x-&gt;link);</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next;</highlight></codeline>
<codeline lineno="1168"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"></highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1171" refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" kindref="member">ps_lattice_reverse_edges</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*start,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*end)</highlight></codeline>
<codeline lineno="1172"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Cancel<sp/>any<sp/>unfinished<sp/>traversal.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" kindref="member">ps_lattice_delq</ref>(dag);</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>node<sp/>fanout<sp/>counts<sp/>and<sp/>path<sp/>scores.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++node-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref>;</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>agenda<sp/>with<sp/>all<sp/>entries<sp/>from<sp/>end.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(end<sp/>==<sp/>NULL)<sp/>end<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>;</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>end-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" kindref="member">ps_lattice_pushq</ref>(dag,<sp/>x-&gt;link);</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pull<sp/>the<sp/>first<sp/>edge<sp/>off<sp/>the<sp/>queue.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" kindref="member">ps_lattice_reverse_next</ref>(dag,<sp/>start);</highlight></codeline>
<codeline lineno="1193"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"></highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1196" refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" kindref="member">ps_lattice_reverse_next</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*start)</highlight></codeline>
<codeline lineno="1197"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*next;</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"></highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/>next<sp/>=<sp/><ref refid="ps__lattice_8c_1a481c4d941368597e11b0af4709bd03b0" kindref="member">ps_lattice_popq</ref>(dag);</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"></highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Decrease<sp/>fanout<sp/>count<sp/>for<sp/>source<sp/>node<sp/>and<sp/>expand<sp/>incoming</highlight></codeline>
<codeline lineno="1205"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>edges<sp/>if<sp/>all<sp/>incoming<sp/>edges<sp/>have<sp/>been<sp/>seen.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/>--next-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref>;</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;info.<ref refid="structps__latnode__s_1a74ba4cfd8ebbb73772b8377d4517d9c0" kindref="member">fanin</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"></highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(start<sp/>==<sp/>NULL)<sp/>start<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>;</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>==<sp/>start)<sp/>{</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>we<sp/>have<sp/>traversed<sp/>all<sp/>links<sp/>entering<sp/>the<sp/>start<sp/>node,</highlight></codeline>
<codeline lineno="1213"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>clear<sp/>the<sp/>queue,<sp/>causing<sp/>future<sp/>calls<sp/>to<sp/>this<sp/>function</highlight></codeline>
<codeline lineno="1214"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>return<sp/>NULL.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1ad128ca75e8bc7ca4ba41094fb5b68ee9" kindref="member">ps_lattice_delq</ref>(dag);</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next;</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"></highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Extend<sp/>all<sp/>outgoing<sp/>edges.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>next-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a04896ebe0e2592bc7950d413b5d5c52e" kindref="member">ps_lattice_pushq</ref>(dag,<sp/>x-&gt;link);</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"></highlight></codeline>
<codeline lineno="1226"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1227"><highlight class="comment"><sp/>*<sp/>Find<sp/>the<sp/>best<sp/>score<sp/>from<sp/>dag-&gt;start<sp/>to<sp/>end<sp/>point<sp/>of<sp/>any<sp/>link<sp/>and</highlight></codeline>
<codeline lineno="1228"><highlight class="comment"><sp/>*<sp/>use<sp/>it<sp/>to<sp/>update<sp/>links<sp/>further<sp/>down<sp/>the<sp/>path.<sp/><sp/>This<sp/>is<sp/>like</highlight></codeline>
<codeline lineno="1229"><highlight class="comment"><sp/>*<sp/>single-source<sp/>shortest<sp/>path<sp/>search,<sp/>except<sp/>that<sp/>it<sp/>is<sp/>done<sp/>over</highlight></codeline>
<codeline lineno="1230"><highlight class="comment"><sp/>*<sp/>edges<sp/>rather<sp/>than<sp/>nodes,<sp/>which<sp/>allows<sp/>us<sp/>to<sp/>do<sp/>exact<sp/>trigram<sp/>scoring.</highlight></codeline>
<codeline lineno="1231"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="1232"><highlight class="comment"><sp/>*<sp/>Helpfully<sp/>enough,<sp/>we<sp/>get<sp/>half<sp/>of<sp/>the<sp/>posterior<sp/>probability</highlight></codeline>
<codeline lineno="1233"><highlight class="comment"><sp/>*<sp/>calculation<sp/>for<sp/>free<sp/>that<sp/>way<sp/>too.<sp/><sp/>(interesting<sp/>research<sp/>topic:<sp/>is</highlight></codeline>
<codeline lineno="1234"><highlight class="comment"><sp/>*<sp/>there<sp/>a<sp/>reliable<sp/>Viterbi<sp/>analogue<sp/>to<sp/>word-level<sp/>Forward-Backward</highlight></codeline>
<codeline lineno="1235"><highlight class="comment"><sp/>*<sp/>like<sp/>there<sp/>is<sp/>for<sp/>state-level?<sp/><sp/>Or,<sp/>is<sp/>it<sp/>just<sp/>lattice<sp/>density?)</highlight></codeline>
<codeline lineno="1236"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1238" refid="ps__lattice_8c_1a0cc8e4824f4f23ecbf511b0bb096a3ea" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a0cc8e4824f4f23ecbf511b0bb096a3ea" kindref="member">ps_lattice_bestpath</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/>ngram_model_t<sp/>*lmset,</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float32<sp/>lwf,<sp/>float32<sp/>ascale)</highlight></codeline>
<codeline lineno="1240"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__search__s" kindref="compound">ps_search_t</ref><sp/>*search;</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link;</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*bestend;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/>logmath_t<sp/>*lmath;</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>bestescr;</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"></highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/>search<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>;</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/>lmath<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>;</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"></highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>path<sp/>scores<sp/>for<sp/>all<sp/>links<sp/>exiting<sp/>dag-&gt;start,<sp/>and</highlight></codeline>
<codeline lineno="1253"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>set<sp/>all<sp/>other<sp/>scores<sp/>to<sp/>the<sp/>minimum.<sp/><sp/>Also<sp/>initialize<sp/>alphas<sp/>to</highlight></codeline>
<codeline lineno="1254"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>log-zero.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/>=<sp/>MAX_NEG_INT32;</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>=<sp/>logmath_get_zero(lmath);</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>n_used;</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Ignore<sp/>filler<sp/>words.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Best<sp/>path<sp/>points<sp/>to<sp/>dag-&gt;start,<sp/>obviously.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lmset)</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/>=<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>+</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(ngram_bg_score(lmset,<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ps_search_start_wid(search),<sp/>&amp;n_used)<sp/></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>lwf;</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/>=<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>;</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;best_prev<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>No<sp/>predecessors<sp/>for<sp/>start<sp/>links.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"></highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Traverse<sp/>the<sp/>edges<sp/>in<sp/>the<sp/>graph,<sp/>updating<sp/>path<sp/>scores.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(link<sp/>=<sp/><ref refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" kindref="member">ps_lattice_traverse_edges</ref>(dag,<sp/>NULL,<sp/>NULL);</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link;<sp/>link<sp/>=<sp/><ref refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" kindref="member">ps_lattice_traverse_next</ref>(dag,<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>bprob,<sp/>n_used;</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"></highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>filler<sp/>nodes<sp/>in<sp/>traversal.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)<sp/>&amp;&amp;<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>)</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)<sp/>&amp;&amp;<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"></highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sanity<sp/>check,<sp/>we<sp/>should<sp/>not<sp/>be<sp/>traversing<sp/>edges<sp/>that</highlight></codeline>
<codeline lineno="1295"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>weren&apos;t<sp/>previously<sp/>updated,<sp/>otherwise<sp/>nasty<sp/>overflows<sp/>will<sp/>result.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/>!=<sp/>MAX_NEG_INT32);</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Calculate<sp/>common<sp/>bigram<sp/>probability<sp/>for<sp/>all<sp/>alphas.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lmset)</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bprob<sp/>=<sp/>ngram_ng_prob(lmset,</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>1,<sp/>&amp;n_used);</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bprob<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Add<sp/>in<sp/>this<sp/>link&apos;s<sp/>acoustic<sp/>score,<sp/>which<sp/>was<sp/>a<sp/>constant</highlight></codeline>
<codeline lineno="1306"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>in<sp/>previous<sp/>computations<sp/>(if<sp/>any).<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+=<sp/>(link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)<sp/>*<sp/>ascale;</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>scores<sp/>for<sp/>all<sp/>paths<sp/>exiting<sp/>link-&gt;to.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>tscore,<sp/>score;</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"></highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>links<sp/>to<sp/>filler<sp/>words<sp/>in<sp/>update.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"></highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>alpha<sp/>with<sp/>sum<sp/>of<sp/>previous<sp/>alphas.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>=<sp/>logmath_add(lmath,<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref>,<sp/>link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>bprob);</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Calculate<sp/>trigram<sp/>score<sp/>for<sp/>bestpath.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lmset)</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tscore<sp/>=<sp/>(ngram_tg_score(lmset,<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>&amp;n_used)<sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>lwf;</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tscore<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>link<sp/>score<sp/>with<sp/>maximum<sp/>link<sp/>score.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/>+<sp/>tscore<sp/>+<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>;</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(score<sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/>=<sp/>score;</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;best_prev<sp/>=<sp/>link;</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Find<sp/>best<sp/>link<sp/>entering<sp/>final<sp/>node,<sp/>and<sp/>calculate<sp/>normalizer</highlight></codeline>
<codeline lineno="1338"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>for<sp/>posterior<sp/>probabilities.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/>bestend<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/>bestescr<sp/>=<sp/>MAX_NEG_INT32;</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Normalizer<sp/>is<sp/>the<sp/>alpha<sp/>for<sp/>the<sp/>imaginary<sp/>link<sp/>exiting<sp/>the</highlight></codeline>
<codeline lineno="1343"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>final<sp/>node.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref><sp/>=<sp/>logmath_get_zero(lmath);</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>bprob,<sp/>n_used;</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"></highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lmset)</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bprob<sp/>=<sp/>ngram_ng_prob(lmset,</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;x-&gt;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>1,<sp/>&amp;n_used);</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bprob<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref><sp/>=<sp/>logmath_add(lmath,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>,<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>bprob);</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>bestescr)<sp/>{</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestescr<sp/>=<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref>;</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestend<sp/>=<sp/>x-&gt;link;</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>floating<sp/>point...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref><sp/>+=<sp/>(int32)(dag-&gt;<ref refid="structps__lattice__s_1aba113d4134c72d7405423c77bcc1247e" kindref="member">final_node_ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)<sp/>*<sp/>ascale;</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"></highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/>E_INFO(</highlight><highlight class="stringliteral">&quot;Normalizer<sp/>P(O)<sp/>=<sp/>alpha(%s:%d:%d)<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dict_wordstr(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>-&gt;<ref refid="structps__search__s_1a918f243fa966e72c47f697fb9e60089d" kindref="member">dict</ref>,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>),</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" kindref="member">lef</ref>,</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>);</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bestend;</highlight></codeline>
<codeline lineno="1370"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"></highlight></codeline>
<codeline lineno="1372"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>int32</highlight></codeline>
<codeline lineno="1373"><highlight class="normal">ps_lattice_joint(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link,<sp/>float32<sp/>ascale)</highlight></codeline>
<codeline lineno="1374"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/>ngram_model_t<sp/>*lmset;</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>jprob;</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"></highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Sort<sp/>of<sp/>a<sp/>hack...<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref><sp/>&amp;&amp;<sp/>0<sp/>==<sp/>strcmp(ps_search_name(dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>),<sp/>PS_SEARCH_NGRAM))</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lmset<sp/>=<sp/>((<ref refid="structngram__search__s" kindref="compound">ngram_search_t</ref><sp/>*)dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>)-&gt;lmset;</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lmset<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"></highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/>jprob<sp/>=<sp/>(dag-&gt;<ref refid="structps__lattice__s_1aba113d4134c72d7405423c77bcc1247e" kindref="member">final_node_ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)<sp/>*<sp/>ascale;</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(link)<sp/>{</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lmset)<sp/>{</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lback;</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Compute<sp/>unscaled<sp/>language<sp/>model<sp/>probability.<sp/><sp/>Note<sp/>that</highlight></codeline>
<codeline lineno="1389"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this<sp/>is<sp/>actually<sp/>not<sp/>the<sp/>language<sp/>model<sp/>probability</highlight></codeline>
<codeline lineno="1390"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>corresponds<sp/>to<sp/>this<sp/>link,<sp/>but<sp/>that<sp/>is<sp/>okay,</highlight></codeline>
<codeline lineno="1391"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>because<sp/>we<sp/>are<sp/>just<sp/>taking<sp/>the<sp/>sum<sp/>over<sp/>all<sp/>links<sp/>in</highlight></codeline>
<codeline lineno="1392"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>best<sp/>path.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jprob<sp/>+=<sp/>ngram_ng_prob(lmset,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>1,<sp/>&amp;lback);</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>there<sp/>is<sp/>no<sp/>language<sp/>model,<sp/>we<sp/>assume<sp/>that<sp/>the<sp/>language</highlight></codeline>
<codeline lineno="1397"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>model<sp/>probability<sp/>(such<sp/>as<sp/>it<sp/>is)<sp/>has<sp/>been<sp/>included<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="1398"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link<sp/>score.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>jprob<sp/>+=<sp/>(link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)<sp/>*<sp/>ascale;</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link<sp/>=<sp/>link-&gt;best_prev;</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"></highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/>E_INFO(</highlight><highlight class="stringliteral">&quot;Joint<sp/>P(O,S)<sp/>=<sp/>%d<sp/>P(S|O)<sp/>=<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>jprob,<sp/>jprob<sp/>-<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>);</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>jprob;</highlight></codeline>
<codeline lineno="1405"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight></codeline>
<codeline lineno="1407"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1408" refid="ps__lattice_8c_1aafee8a8325301db72711a3680bc385c6" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1aafee8a8325301db72711a3680bc385c6" kindref="member">ps_lattice_posterior</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/>ngram_model_t<sp/>*lmset,</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float32<sp/>ascale)</highlight></codeline>
<codeline lineno="1410"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__search__s" kindref="compound">ps_search_t</ref><sp/>*search;</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/>logmath_t<sp/>*lmath;</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link;</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*bestend;</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>bestescr;</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"></highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/>search<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>;</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/>lmath<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a28f4ff5039e0961d57331d2605801010" kindref="member">lmath</ref>;</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"></highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Reset<sp/>all<sp/>betas<sp/>to<sp/>zero.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>=<sp/>logmath_get_zero(lmath);</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"></highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/>bestend<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/>bestescr<sp/>=<sp/>MAX_NEG_INT32;</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Accumulate<sp/>backward<sp/>probabilities<sp/>for<sp/>all<sp/>links.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(link<sp/>=<sp/><ref refid="ps__lattice_8c_1a33e1a31ff250c7e7d555e179e2693f5d" kindref="member">ps_lattice_reverse_edges</ref>(dag,<sp/>NULL,<sp/>NULL);</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link;<sp/>link<sp/>=<sp/><ref refid="ps__lattice_8c_1a7a6e0cb0510310b13fd4286cf8f48792" kindref="member">ps_lattice_reverse_next</ref>(dag,<sp/>NULL))<sp/>{</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>bprob,<sp/>n_used;</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"></highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>filler<sp/>nodes<sp/>in<sp/>traversal.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)<sp/>&amp;&amp;<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>)</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)<sp/>&amp;&amp;<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"></highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Calculate<sp/>LM<sp/>probability.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lmset)</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bprob<sp/>=<sp/>ngram_ng_prob(lmset,<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>1,<sp/>&amp;n_used);</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bprob<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>==<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Track<sp/>the<sp/>best<sp/>path<sp/>-<sp/>we<sp/>will<sp/>backtrace<sp/>in<sp/>order<sp/>to</highlight></codeline>
<codeline lineno="1451"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calculate<sp/>the<sp/>unscaled<sp/>joint<sp/>probability<sp/>for<sp/>sentence</highlight></codeline>
<codeline lineno="1452"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>posterior.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref><sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>bestescr)<sp/>{</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestescr<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a704fcfbdb57b1461325544c782289599" kindref="member">path_scr</ref>;</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestend<sp/>=<sp/>link;</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Imaginary<sp/>exit<sp/>link<sp/>from<sp/>final<sp/>node<sp/>has<sp/>beta<sp/>=<sp/>1.0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>=<sp/>bprob<sp/>+<sp/>(dag-&gt;<ref refid="structps__lattice__s_1aba113d4134c72d7405423c77bcc1247e" kindref="member">final_node_ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)<sp/>*<sp/>ascale;</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>beta<sp/>from<sp/>all<sp/>outgoing<sp/>betas.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1aa5cade4dc6464c620718b86344540aff" kindref="member">dict_filler_word</ref>(ps_search_dict(search),<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>)<sp/>&amp;&amp;<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref><sp/>!=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>=<sp/>logmath_add(lmath,<sp/>link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref>,</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>+<sp/>bprob</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>(x-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref><sp/>&lt;&lt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)<sp/>*<sp/>ascale);</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"></highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Return<sp/>P(S|O)<sp/>=<sp/>P(O,S)/P(O)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ps_lattice_joint(dag,<sp/>bestend,<sp/>ascale)<sp/>-<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref>;</highlight></codeline>
<codeline lineno="1474"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"></highlight></codeline>
<codeline lineno="1476"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1477" refid="ps__lattice_8c_1a54c24dc8436c39d0ccc044f7b0ef8f3a" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a54c24dc8436c39d0ccc044f7b0ef8f3a" kindref="member">ps_lattice_posterior_prune</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,<sp/>int32<sp/>beam)</highlight></codeline>
<codeline lineno="1478"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latlink__s" kindref="compound">ps_latlink_t</ref><sp/>*link;</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>npruned<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"></highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(link<sp/>=<sp/><ref refid="ps__lattice_8c_1a3bd22d7b0561c81f874c115a200e84b9" kindref="member">ps_lattice_traverse_edges</ref>(dag,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a5d936695a3813e117d20b585d48db8fe" kindref="member">start</ref>,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>);</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link;<sp/>link<sp/>=<sp/><ref refid="ps__lattice_8c_1a8ab5c5bbbcf02a087a81232476dbd2a3" kindref="member">ps_lattice_traverse_next</ref>(dag,<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1af9c4c69f5f85bbc36818357a52432565" kindref="member">reachable</ref><sp/>=<sp/>FALSE;</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(link-&gt;<ref refid="structps__latlink__s_1ad2f031d271f1d875223aae33116d3f40" kindref="member">alpha</ref><sp/>+<sp/>link-&gt;<ref refid="structps__latlink__s_1a4c27cd5d4f514832d3d46993e2ee87df" kindref="member">beta</ref><sp/>-<sp/>dag-&gt;<ref refid="structps__lattice__s_1a68c3259613a16628e1dd2e8147705d8e" kindref="member">norm</ref><sp/>&lt;<sp/>beam)<sp/>{</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x,<sp/>*tmp,<sp/>*next;</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>next)<sp/>{</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next<sp/>=<sp/>x-&gt;next;</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link<sp/>==<sp/>link)<sp/>{</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>x);</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;next<sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1ab0912c26d1472b4c5c07042c19ffb979" kindref="member">from</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref><sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref>;<sp/>x;<sp/>x<sp/>=<sp/>next)<sp/>{</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next<sp/>=<sp/>x-&gt;next;</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link<sp/>==<sp/>link)<sp/>{</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1a8e9cfaf92f9a3588d018578854c61e88" kindref="member">latlink_list_alloc</ref>,<sp/>x);</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x-&gt;next<sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1a051a7eed31e29dd75151d1b34cc4eefa" kindref="member">entries</ref><sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(dag-&gt;<ref refid="structps__lattice__s_1afa8ca535dc8bf2cc656f6ad477e13b9f" kindref="member">latlink_alloc</ref>,<sp/>link);</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++npruned;</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/>dag_mark_reachable(dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>);</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="ps__lattice_8c_1a6da4e36322aaab4d2ebe812bee9a4439" kindref="member">ps_lattice_delete_unreachable</ref>(dag);</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>npruned;</highlight></codeline>
<codeline lineno="1518"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="normal"></highlight></codeline>
<codeline lineno="1521"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Parameters<sp/>to<sp/>prune<sp/>n-best<sp/>alternatives<sp/>search<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MAX_PATHS<sp/><sp/><sp/><sp/><sp/><sp/><sp/>500<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Max<sp/>allowed<sp/>active<sp/>paths<sp/>at<sp/>any<sp/>time<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="1523"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>MAX_HYP_TRIES<sp/><sp/><sp/>10000</highlight></codeline>
<codeline lineno="1524"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1525"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1526"><highlight class="comment"><sp/>*<sp/>For<sp/>each<sp/>node<sp/>in<sp/>any<sp/>path<sp/>between<sp/>from<sp/>and<sp/>end<sp/>of<sp/>utt,<sp/>find<sp/>the</highlight></codeline>
<codeline lineno="1527"><highlight class="comment"><sp/>*<sp/>best<sp/>score<sp/>from<sp/>&quot;from&quot;.sf<sp/>to<sp/>end<sp/>of<sp/>utt.<sp/><sp/>(NOTE:<sp/>Uses<sp/>bigram<sp/>probs;</highlight></codeline>
<codeline lineno="1528"><highlight class="comment"><sp/>*<sp/>this<sp/>is<sp/>an<sp/>estimate<sp/>of<sp/>the<sp/>best<sp/>score<sp/>from<sp/>&quot;from&quot;.)<sp/><sp/>(NOTE<sp/>#2:<sp/>yes,</highlight></codeline>
<codeline lineno="1529"><highlight class="comment"><sp/>*<sp/>this<sp/>is<sp/>the<sp/>&quot;heuristic<sp/>score&quot;<sp/>used<sp/>in<sp/>A*<sp/>search)</highlight></codeline>
<codeline lineno="1530"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>int32</highlight></codeline>
<codeline lineno="1532"><highlight class="normal">best_rem_score(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest,<sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*<sp/>from)</highlight></codeline>
<codeline lineno="1533"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>bestscore,<sp/>score;</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"></highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(from-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref><sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(from-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref>);</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Best<sp/>score<sp/>from<sp/>&quot;from&quot;<sp/>to<sp/>end<sp/>of<sp/>utt<sp/>not<sp/>known;<sp/>compute<sp/>from<sp/>successors<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/>bestscore<sp/>=<sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref>;</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>from-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>n_used;</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"></highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>=<sp/>best_rem_score(nbest,<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>);</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>+=<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>;</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nbest-&gt;lmset)</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>+=<sp/>(ngram_bg_score(nbest-&gt;lmset,<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>&amp;n_used)<sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>)</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>nbest-&gt;lwf;</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(score<sp/><ref refid="hmm_8h_1a2874ab52613ff781c96f570ec0eb0d98" kindref="member">BETTER_THAN</ref><sp/>bestscore)</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestscore<sp/>=<sp/>score;</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/>from-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref><sp/>=<sp/>bestscore;</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"></highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bestscore;</highlight></codeline>
<codeline lineno="1557"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"></highlight></codeline>
<codeline lineno="1559"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1560"><highlight class="comment"><sp/>*<sp/>Insert<sp/>newpath<sp/>in<sp/>sorted<sp/>(by<sp/>path<sp/>score)<sp/>list<sp/>of<sp/>paths.<sp/><sp/>But<sp/>if<sp/>newpath<sp/>is</highlight></codeline>
<codeline lineno="1561"><highlight class="comment"><sp/>*<sp/>too<sp/>far<sp/>down<sp/>the<sp/>list,<sp/>drop<sp/>it<sp/>(FIXME:<sp/>necessary?)</highlight></codeline>
<codeline lineno="1562"><highlight class="comment"><sp/>*<sp/>total_score<sp/>=<sp/>path<sp/>score<sp/>(newpath)<sp/>+<sp/>rem_score<sp/>to<sp/>end<sp/>of<sp/>utt.</highlight></codeline>
<codeline lineno="1563"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1564"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1565"><highlight class="normal">path_insert(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest,<sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*newpath,<sp/>int32<sp/>total_score)</highlight></codeline>
<codeline lineno="1566"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*prev,<sp/>*p;</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i;</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/>prev<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>p<sp/>=<sp/>nbest-&gt;path_list;<sp/>(i<sp/>&lt;<sp/>MAX_PATHS)<sp/>&amp;&amp;<sp/>p;<sp/>p<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" kindref="member">next</ref>,<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((p-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>+<sp/>p-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref>)<sp/>&lt;<sp/>total_score)</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev<sp/>=<sp/>p;</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"></highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>newpath<sp/>should<sp/>be<sp/>inserted<sp/>between<sp/>prev<sp/>and<sp/>p<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>MAX_PATHS)<sp/>{</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Insert<sp/>new<sp/>partial<sp/>hyp<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath-&gt;<ref refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" kindref="member">next</ref><sp/>=<sp/>p;</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!prev)</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;path_list<sp/>=<sp/>newpath;</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev-&gt;<ref refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" kindref="member">next</ref><sp/>=<sp/>newpath;</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!p)</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;path_tail<sp/>=<sp/>newpath;</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"></highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_path++;</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_hyp_insert++;</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;insert_depth<sp/>+=<sp/>i;</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>newpath<sp/>score<sp/>too<sp/>low;<sp/>reject<sp/>it<sp/>and<sp/>also<sp/>prune<sp/>paths<sp/>beyond<sp/>MAX_PATHS<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;path_tail<sp/>=<sp/>prev;</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev-&gt;<ref refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" kindref="member">next</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_path<sp/>=<sp/>MAX_PATHS;</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref>,<sp/>newpath);</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"></highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_hyp_reject++;</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>p;<sp/>p<sp/>=<sp/>newpath)<sp/>{</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref>,<sp/>p);</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_hyp_reject++;</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1606"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"></highlight></codeline>
<codeline lineno="1608"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Find<sp/>all<sp/>possible<sp/>extensions<sp/>to<sp/>given<sp/>partial<sp/>path<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1610"><highlight class="normal">path_extend(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest,<sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*<sp/>path)</highlight></codeline>
<codeline lineno="1611"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structlatlink__list__s" kindref="compound">latlink_list_t</ref><sp/>*x;</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*newpath;</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>total_score,<sp/>tail_score;</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"></highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Consider<sp/>all<sp/>successors<sp/>of<sp/>path-&gt;node<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>path-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref>;<sp/>x;<sp/>x<sp/>=<sp/>x-&gt;next)<sp/>{</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>n_used;</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"></highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>successor<sp/>if<sp/>no<sp/>path<sp/>from<sp/>it<sp/>reaches<sp/>the<sp/>final<sp/>node<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref><sp/>&lt;=<sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref>)</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"></highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>path<sp/>extension<sp/>and<sp/>compute<sp/>exact<sp/>score<sp/>for<sp/>this<sp/>extension<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath<sp/>=<sp/>listelem_malloc(nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref>);</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref><sp/>=<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1a782a15b1aeabf68983ca521e51f2c1e1" kindref="member">to</ref>;</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref><sp/>=<sp/>path;</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>=<sp/>path-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>+<sp/>x-&gt;link-&gt;<ref refid="structps__latlink__s_1ae8a94ce1afb49292b044a0d4ba42b46d" kindref="member">ascr</ref>;</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nbest-&gt;lmset)<sp/>{</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(path-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>+=<sp/>nbest-&gt;lwf</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(ngram_tg_score(nbest-&gt;lmset,<sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref>-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>&amp;n_used)</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>);</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>+=<sp/>nbest-&gt;lwf</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(ngram_bg_score(nbest-&gt;lmset,<sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>&amp;n_used)</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&gt;&gt;<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>);</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Insert<sp/>new<sp/>partial<sp/>path<sp/>hypothesis<sp/>into<sp/>sorted<sp/>path_list<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_hyp_tried++;</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>total_score<sp/>=<sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>+<sp/>newpath-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref>;</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"></highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>First<sp/>see<sp/>if<sp/>hyp<sp/>would<sp/>be<sp/>worse<sp/>than<sp/>the<sp/>worst<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nbest-&gt;n_path<sp/>&gt;=<sp/>MAX_PATHS)<sp/>{</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tail_score<sp/>=</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;path_tail-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref></highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>nbest-&gt;path_tail-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref>;</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(total_score<sp/>&lt;<sp/>tail_score)<sp/>{</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>listelem_free(nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref>,<sp/>newpath);</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_hyp_reject++;</highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"></highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path_insert(nbest,<sp/>newpath,<sp/>total_score);</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1662"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1665" refid="ps__lattice__internal_8h_1aaf9aedd3cd8bd1d45053e10828215a25" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1aaf9aedd3cd8bd1d45053e10828215a25" kindref="member">ps_astar_start</ref>(<ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag,</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ngram_model_t<sp/>*lmset,</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float32<sp/>lwf,</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sf,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ef,</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>w1,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>w2)</highlight></codeline>
<codeline lineno="1670"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest;</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"></highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest<sp/>=<sp/>ckd_calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*nbest));</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;dag<sp/>=<sp/>dag;</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;lmset<sp/>=<sp/>lmset;</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;lwf<sp/>=<sp/>lwf;</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;sf<sp/>=<sp/>sf;</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ef<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;ef<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a3a997dc60d28b84d5bfc01f9ce25a891" kindref="member">n_frames</ref><sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;ef<sp/>=<sp/>ef;</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;w1<sp/>=<sp/>w1;</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;w2<sp/>=<sp/>w2;</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref><sp/>=<sp/>listelem_alloc_init(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref>));</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"></highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initialize<sp/>rem_score<sp/>(A*<sp/>heuristic)<sp/>to<sp/>default<sp/>values<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(node<sp/>==<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(node-&gt;<ref refid="structps__latnode__s_1a5232eefbc6e800b77e7a3c8ee3f4135d" kindref="member">exits</ref><sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref><sp/>=<sp/><ref refid="hmm_8h_1a833f100ee293ad0f1c03f2a5ef9be77a" kindref="member">WORST_SCORE</ref>;</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref><sp/>=<sp/>1;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>+ve<sp/>=&gt;<sp/>unknown<sp/>value<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"></highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Create<sp/>initial<sp/>partial<sp/>hypotheses<sp/>list<sp/>consisting<sp/>of<sp/>nodes<sp/>starting<sp/>at<sp/>sf<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;path_list<sp/>=<sp/>nbest-&gt;path_tail<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(node<sp/>=<sp/>dag-&gt;<ref refid="structps__lattice__s_1a838bd9223e35d012419e6225b54e393d" kindref="member">nodes</ref>;<sp/>node;<sp/>node<sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1aca6f3d543a1712a1ca3bb8ec60f71c84" kindref="member">next</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(node-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref><sp/>==<sp/>sf)<sp/>{</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*path;</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>n_used;</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"></highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_rem_score(nbest,<sp/>node);</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/>listelem_malloc(nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref>);</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref><sp/>=<sp/>node;</highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nbest-&gt;lmset)</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>=<sp/>nbest-&gt;lwf<sp/>*</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((w1<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/>ngram_bg_score(nbest-&gt;lmset,<sp/>node-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>w2,<sp/>&amp;n_used)</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>ngram_tg_score(nbest-&gt;lmset,<sp/>node-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>,<sp/>w2,<sp/>w1,<sp/>&amp;n_used));</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>&gt;&gt;=<sp/><ref refid="hmm_8h_1af94da16e3e5b550b9be05b0f07402cc7" kindref="member">SENSCR_SHIFT</ref>;</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path_insert(nbest,<sp/>path,<sp/>path-&gt;<ref refid="structps__latpath__s_1a9249fb528f754db992df1d494a69b580" kindref="member">score</ref><sp/>+<sp/>node-&gt;info.<ref refid="structps__latnode__s_1ac0e665aedad3044c79b35c4038627a77" kindref="member">rem_score</ref>);</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"></highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nbest;</highlight></codeline>
<codeline lineno="1721"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"></highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1724" refid="ps__lattice__internal_8h_1a6bea95f8fb827af790bbe6ce1920908c" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1a6bea95f8fb827af790bbe6ce1920908c" kindref="member">ps_astar_next</ref>(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest)</highlight></codeline>
<codeline lineno="1725"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__lattice__s" kindref="compound">ps_lattice_t</ref><sp/>*dag;</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"></highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/>dag<sp/>=<sp/>nbest-&gt;dag;</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"></highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Pop<sp/>the<sp/>top<sp/>(best)<sp/>partial<sp/>hypothesis<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((nbest-&gt;top<sp/>=<sp/>nbest-&gt;path_list)<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;path_list<sp/>=<sp/>nbest-&gt;path_list-&gt;<ref refid="structps__latpath__s_1a614ad4a857fb07f76959d385abf50a6d" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nbest-&gt;top<sp/>==<sp/>nbest-&gt;path_tail)</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;path_tail<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nbest-&gt;n_path--;</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Complete<sp/>hypothesis?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((nbest-&gt;top-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref><sp/>&gt;=<sp/>nbest-&gt;ef)</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>((nbest-&gt;top-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref><sp/>==<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(nbest-&gt;ef<sp/>&gt;<sp/>dag-&gt;<ref refid="structps__lattice__s_1a00f30e2689853d6bcb31c8005a69dc7b" kindref="member">end</ref>-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>)))<sp/>{</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>Verify<sp/>that<sp/>it<sp/>is<sp/>non-empty.<sp/><sp/>Also<sp/>we<sp/>may<sp/>want</highlight></codeline>
<codeline lineno="1742"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>to<sp/>verify<sp/>that<sp/>it<sp/>is<sp/>actually<sp/>distinct<sp/>from<sp/>other</highlight></codeline>
<codeline lineno="1743"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>paths,<sp/>since<sp/>often<sp/>this<sp/>is<sp/>not<sp/>the<sp/>case*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nbest-&gt;top;</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nbest-&gt;top-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1a584ee5a303355d851ac903718998df14" kindref="member">fef</ref><sp/>&lt;<sp/>nbest-&gt;ef)</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path_extend(nbest,<sp/>nbest-&gt;top);</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"></highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Did<sp/>not<sp/>find<sp/>any<sp/>more<sp/>paths<sp/>to<sp/>extend.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1754"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"></highlight></codeline>
<codeline lineno="1756"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="1757" refid="ps__lattice__internal_8h_1ac7372b5c5ec111f6814ce1ba495593e4" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1ac7372b5c5ec111f6814ce1ba495593e4" kindref="member">ps_astar_hyp</ref>(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest,<sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*path)</highlight></codeline>
<codeline lineno="1758"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__search__s" kindref="compound">ps_search_t</ref><sp/>*search;</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*p;</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*c;</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*hyp;</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"></highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/>search<sp/>=<sp/>nbest-&gt;dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>;</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"></highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Backtrace<sp/>once<sp/>to<sp/>get<sp/>hypothesis<sp/>length.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>path;<sp/>p;<sp/>p<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" kindref="member">dict_real_word</ref>(ps_search_dict(search),<sp/>p-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wstr<sp/>=<sp/>dict_wordstr(ps_search_dict(search),<sp/>p-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wstr<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>+=<sp/>strlen(wstr)<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"></highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1780"><highlight class="normal"></highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Backtrace<sp/>again<sp/>to<sp/>construct<sp/>hypothesis<sp/>string.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/>hyp<sp/>=<sp/>ckd_calloc(1,<sp/>len);</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/>c<sp/>=<sp/>hyp<sp/>+<sp/>len<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>path;<sp/>p;<sp/>p<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="dict_8h_1ad2eba4ca92dd1a3721608e003d95d8c1" kindref="member">dict_real_word</ref>(ps_search_dict(search),<sp/>p-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*wstr<sp/>=<sp/>dict_wordstr(ps_search_dict(search),<sp/>p-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>-&gt;<ref refid="structps__latnode__s_1ae3b3dc7d14347e6380859c74b9a02589" kindref="member">basewid</ref>);</highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(wstr<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>strlen(wstr);</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>-=<sp/>len;</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(c,<sp/>wstr,<sp/>len);</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>&gt;<sp/>hyp)<sp/>{</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--c;</highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*c<sp/>=<sp/></highlight><highlight class="charliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1798"><highlight class="normal"></highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/>nbest-&gt;<ref refid="structps__astar__s_1ace603617a74a81575519ae1bb94720c4" kindref="member">hyps</ref><sp/>=<sp/>glist_add_ptr(nbest-&gt;<ref refid="structps__astar__s_1ace603617a74a81575519ae1bb94720c4" kindref="member">hyps</ref>,<sp/>hyp);</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hyp;</highlight></codeline>
<codeline lineno="1801"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"></highlight></codeline>
<codeline lineno="1803"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal">ps_astar_node2itor(<ref refid="structastar__seg__s" kindref="compound">astar_seg_t</ref><sp/>*itor)</highlight></codeline>
<codeline lineno="1805"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg<sp/>=<sp/>(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*)itor;</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latnode__s" kindref="compound">ps_latnode_t</ref><sp/>*node;</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"></highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/>assert(itor-&gt;cur<sp/>&lt;<sp/>itor-&gt;n_nodes);</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/>node<sp/>=<sp/>itor-&gt;nodes[itor-&gt;cur];</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itor-&gt;cur<sp/>==<sp/>itor-&gt;n_nodes<sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ab25ecc6af8d2695c6097cf7e934eadd4" kindref="member">ef</ref><sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a5c7b9114d131151d6ce85228ea9f829d" kindref="member">lef</ref>;</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ab25ecc6af8d2695c6097cf7e934eadd4" kindref="member">ef</ref><sp/>=<sp/>itor-&gt;nodes[itor-&gt;cur<sp/>+<sp/>1]-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref><sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a97a0dc7db931c7e3f98d23d21ce27f04" kindref="member">word</ref><sp/>=<sp/>dict_wordstr(ps_search_dict(seg-&gt;<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref>),<sp/>node-&gt;<ref refid="structps__latnode__s_1afd85dbd410d6e6d970c73088bc6fb97e" kindref="member">wid</ref>);</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1a885a599726cd0efba573d106d016e6e2" kindref="member">sf</ref><sp/>=<sp/>node-&gt;<ref refid="structps__latnode__s_1a4171e956043e7856c04d84498f16cf29" kindref="member">sf</ref>;</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;<ref refid="structps__seg__s_1ae683244d90d0a5339930b47757778432" kindref="member">prob</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">/*<sp/>FIXME:<sp/>implement<sp/>forward-backward<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1818"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"></highlight></codeline>
<codeline lineno="1820"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal">ps_astar_seg_free(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg)</highlight></codeline>
<codeline lineno="1822"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structastar__seg__s" kindref="compound">astar_seg_t</ref><sp/>*itor<sp/>=<sp/>(<ref refid="structastar__seg__s" kindref="compound">astar_seg_t</ref><sp/>*)seg;</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(itor-&gt;nodes);</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(itor);</highlight></codeline>
<codeline lineno="1826"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"></highlight></codeline>
<codeline lineno="1828"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1829"><highlight class="normal">ps_astar_seg_next(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*seg)</highlight></codeline>
<codeline lineno="1830"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structastar__seg__s" kindref="compound">astar_seg_t</ref><sp/>*itor<sp/>=<sp/>(<ref refid="structastar__seg__s" kindref="compound">astar_seg_t</ref><sp/>*)seg;</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"></highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/>++itor-&gt;cur;</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(itor-&gt;cur<sp/>==<sp/>itor-&gt;n_nodes)<sp/>{</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ps_astar_seg_free(seg);</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ps_astar_node2itor(itor);</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"></highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>seg;</highlight></codeline>
<codeline lineno="1843"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"></highlight></codeline>
<codeline lineno="1845"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structps__segfuncs__s" kindref="compound">ps_segfuncs_t</ref><sp/>ps_astar_segfuncs<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>seg_next<sp/>*/</highlight><highlight class="normal"><sp/>ps_astar_seg_next,</highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>seg_free<sp/>*/</highlight><highlight class="normal"><sp/>ps_astar_seg_free</highlight></codeline>
<codeline lineno="1848"><highlight class="normal">};</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"></highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1851" refid="ps__lattice__internal_8h_1ac8e3dff7276c03c93377d0cb79fbdbd7" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1ac8e3dff7276c03c93377d0cb79fbdbd7" kindref="member">ps_astar_seg_iter</ref>(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*astar,<sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*path,<sp/>float32<sp/>lwf)</highlight></codeline>
<codeline lineno="1852"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structastar__seg__s" kindref="compound">astar_seg_t</ref><sp/>*itor;</highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structps__latpath__s" kindref="compound">ps_latpath_t</ref><sp/>*p;</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cur;</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"></highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Backtrace<sp/>and<sp/>make<sp/>an<sp/>iterator,<sp/>this<sp/>should<sp/>look<sp/>familiar<sp/>by<sp/>now.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/>itor<sp/>=<sp/>ckd_calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*itor));</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;base.<ref refid="structps__seg__s_1a510362a2281e374c839397c3e5488515" kindref="member">vt</ref><sp/>=<sp/>&amp;ps_astar_segfuncs;</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;base.<ref refid="structps__seg__s_1a14168ddcb60e094dad36c7c920a79bb3" kindref="member">search</ref><sp/>=<sp/>astar-&gt;dag-&gt;<ref refid="structps__lattice__s_1a9ebaeb7be7a83980569f0c544eb6babb" kindref="member">search</ref>;</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;base.<ref refid="structps__seg__s_1a2249c012b83c902f4f8ed8d98ded7d20" kindref="member">lwf</ref><sp/>=<sp/>lwf;</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;n_nodes<sp/>=<sp/>itor-&gt;cur<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>path;<sp/>p;<sp/>p<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++itor-&gt;n_nodes;</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/>itor-&gt;nodes<sp/>=<sp/>ckd_calloc(itor-&gt;n_nodes,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*itor-&gt;nodes));</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/>cur<sp/>=<sp/>itor-&gt;n_nodes<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(p<sp/>=<sp/>path;<sp/>p;<sp/>p<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a87acd26322fca11aa1432cdf9d1a2128" kindref="member">parent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>itor-&gt;nodes[cur]<sp/>=<sp/>p-&gt;<ref refid="structps__latpath__s_1a9672f7a5002d994985039aece2a69250" kindref="member">node</ref>;</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--cur;</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"></highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/>ps_astar_node2itor(itor);</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="structps__seg__s" kindref="compound">ps_seg_t</ref><sp/>*)itor;</highlight></codeline>
<codeline lineno="1875"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"></highlight></codeline>
<codeline lineno="1877"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1878" refid="ps__lattice__internal_8h_1abfb03e9e0fcbe3def45120f5ba43be14" refkind="member"><highlight class="normal"><ref refid="ps__lattice_8c_1abfb03e9e0fcbe3def45120f5ba43be14" kindref="member">ps_astar_finish</ref>(<ref refid="structps__astar__s" kindref="compound">ps_astar_t</ref><sp/>*nbest)</highlight></codeline>
<codeline lineno="1879"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/>gnode_t<sp/>*gn;</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"></highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Free<sp/>all<sp/>hyps.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(gn<sp/>=<sp/>nbest-&gt;<ref refid="structps__astar__s_1ace603617a74a81575519ae1bb94720c4" kindref="member">hyps</ref>;<sp/>gn;<sp/>gn<sp/>=<sp/>gnode_next(gn))<sp/>{</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ckd_free(gnode_ptr(gn));</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/>glist_free(nbest-&gt;<ref refid="structps__astar__s_1ace603617a74a81575519ae1bb94720c4" kindref="member">hyps</ref>);</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Free<sp/>all<sp/>paths.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/>listelem_alloc_free(nbest-&gt;<ref refid="structps__astar__s_1a754bce124cd92b1b2b6aa6dbbcd73cee" kindref="member">latpath_alloc</ref>);</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Free<sp/>the<sp/>Henge.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/>ckd_free(nbest);</highlight></codeline>
<codeline lineno="1891"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"></highlight></codeline>
<codeline lineno="1893"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>vim:<sp/>set<sp/>ts=4<sp/>sw=4:<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/home/gpuser/cmusphinx-code/pocketsphinx/src/libpocketsphinx/ps_lattice.c"/>
  </compounddef>
</doxygen>
