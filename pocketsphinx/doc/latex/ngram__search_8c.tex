\section{src/libpocketsphinx/ngram\-\_\-search.c File Reference}
\label{ngram__search_8c}\index{src/libpocketsphinx/ngram\-\_\-search.\-c@{src/libpocketsphinx/ngram\-\_\-search.\-c}}


N-\/\-Gram based multi-\/pass search (\char`\"{}\-F\-B\-S\char`\"{})  


{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$assert.\-h$>$}\\*
{\ttfamily \#include $<$sphinxbase/ckd\-\_\-alloc.\-h$>$}\\*
{\ttfamily \#include $<$sphinxbase/listelem\-\_\-alloc.\-h$>$}\\*
{\ttfamily \#include $<$sphinxbase/err.\-h$>$}\\*
{\ttfamily \#include \char`\"{}pocketsphinx\-\_\-internal.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ps\-\_\-lattice\-\_\-internal.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ngram\-\_\-search.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ngram\-\_\-search\-\_\-fwdtree.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ngram\-\_\-search\-\_\-fwdflat.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries N\-G\-R\-A\-M\-\_\-\-H\-I\-S\-T\-O\-R\-Y\-\_\-\-L\-O\-N\-G\-\_\-\-W\-O\-R\-D}~2000 /$\ast$ 20s $\ast$/\label{ngram__search_8c_af9ad6b3d4ef3ad501da8e2296b25a131}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\bf ps\-\_\-search\-\_\-t} $\ast$ {\bf ngram\-\_\-search\-\_\-init} (ngram\-\_\-model\-\_\-t $\ast$lm, cmd\-\_\-ln\-\_\-t $\ast$config, {\bf acmod\-\_\-t} $\ast$acmod, {\bf dict\-\_\-t} $\ast$dict, {\bf dict2pid\-\_\-t} $\ast$d2p)\label{ngram__search_8c_a1db74b6837f13db06470649d3ae84e80}

\begin{DoxyCompactList}\small\item\em Initialize the N-\/\-Gram search module. \end{DoxyCompactList}\item 
void {\bf ngram\-\_\-search\-\_\-free} ({\bf ps\-\_\-search\-\_\-t} $\ast$search)\label{ngram__search_8c_aeaf140dc2bbeaa5c274f73480b5328f3}

\begin{DoxyCompactList}\small\item\em Finalize the N-\/\-Gram search module. \end{DoxyCompactList}\item 
int {\bf ngram\-\_\-search\-\_\-mark\-\_\-bptable} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, int frame\-\_\-idx)
\begin{DoxyCompactList}\small\item\em Record the current frame's index in the backpointer table. \end{DoxyCompactList}\item 
void {\bf ngram\-\_\-search\-\_\-save\-\_\-bp} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, int frame\-\_\-idx, int32 w, int32 score, int32 path, int32 rc)\label{ngram__search_8c_ae36649be6f5a2190e759e7ed13bd7b6b}

\begin{DoxyCompactList}\small\item\em Enter a word in the backpointer table. \end{DoxyCompactList}\item 
int {\bf ngram\-\_\-search\-\_\-find\-\_\-exit} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, int frame\-\_\-idx, int32 $\ast$out\-\_\-best\-\_\-score, int32 $\ast$out\-\_\-is\-\_\-final)
\begin{DoxyCompactList}\small\item\em Find the best word exit for the current frame in the backpointer table. \end{DoxyCompactList}\item 
char const $\ast$ {\bf ngram\-\_\-search\-\_\-bp\-\_\-hyp} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, int bpidx)
\begin{DoxyCompactList}\small\item\em Backtrace from a given backpointer index to obtain a word hypothesis. \end{DoxyCompactList}\item 
void {\bf ngram\-\_\-search\-\_\-alloc\-\_\-all\-\_\-rc} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, int32 w)\label{ngram__search_8c_a1ddcc1a9cb3e164ceb2140097ed23a3e}

\begin{DoxyCompactList}\small\item\em Allocate last phone channels for all possible right contexts for word w. \end{DoxyCompactList}\item 
void {\bf ngram\-\_\-search\-\_\-free\-\_\-all\-\_\-rc} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, int32 w)\label{ngram__search_8c_a15477192481dffcb29e9c4167eff6c3c}

\begin{DoxyCompactList}\small\item\em Allocate last phone channels for all possible right contexts for word w. \end{DoxyCompactList}\item 
int32 {\bf ngram\-\_\-search\-\_\-exit\-\_\-score} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, {\bf bptbl\-\_\-t} $\ast$pbe, int rcphone)\label{ngram__search_8c_a25a80e488425b2bd4e24eb753c9295a5}

\begin{DoxyCompactList}\small\item\em Get the exit score for a backpointer entry with a given right context. \end{DoxyCompactList}\item 
void {\bfseries ngram\-\_\-compute\-\_\-seg\-\_\-score} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs, {\bf bptbl\-\_\-t} $\ast$be, float32 lwf, int32 $\ast$out\-\_\-ascr, int32 $\ast$out\-\_\-lscr)\label{ngram__search_8c_a7526cf720a80052770c5b6f82c93749d}

\item 
void {\bfseries dump\-\_\-bptable} ({\bf ngram\-\_\-search\-\_\-t} $\ast$ngs)\label{ngram__search_8c_ac10e5308e0a48948b3c21bb4c2d80c1b}

\item 
{\bf ps\-\_\-lattice\-\_\-t} $\ast$ {\bf ngram\-\_\-search\-\_\-lattice} ({\bf ps\-\_\-search\-\_\-t} $\ast$search)\label{ngram__search_8c_ac30e7dec4bbfeee9f5163abf4bbd1014}

\begin{DoxyCompactList}\small\item\em Construct a word lattice from the current hypothesis. \end{DoxyCompactList}\item 
void {\bf ngram\-\_\-search\-\_\-set\-\_\-lm} (ngram\-\_\-model\-\_\-t $\ast$lm)
\begin{DoxyCompactList}\small\item\em Sets the global language model. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
N-\/\-Gram based multi-\/pass search (\char`\"{}\-F\-B\-S\char`\"{}) 

Definition in file {\bf ngram\-\_\-search.\-c}.



\subsection{Function Documentation}
\index{ngram\-\_\-search.\-c@{ngram\-\_\-search.\-c}!ngram\-\_\-search\-\_\-bp\-\_\-hyp@{ngram\-\_\-search\-\_\-bp\-\_\-hyp}}
\index{ngram\-\_\-search\-\_\-bp\-\_\-hyp@{ngram\-\_\-search\-\_\-bp\-\_\-hyp}!ngram_search.c@{ngram\-\_\-search.\-c}}
\subsubsection[{ngram\-\_\-search\-\_\-bp\-\_\-hyp}]{\setlength{\rightskip}{0pt plus 5cm}char const$\ast$ ngram\-\_\-search\-\_\-bp\-\_\-hyp (
\begin{DoxyParamCaption}
\item[{{\bf ngram\-\_\-search\-\_\-t} $\ast$}]{ngs, }
\item[{int}]{bpidx}
\end{DoxyParamCaption}
)}\label{ngram__search_8c_aee393a136f8f7e8b98161e6eed7b1dd9}


Backtrace from a given backpointer index to obtain a word hypothesis. 

\begin{DoxyReturn}{Returns}
a {\bfseries read-\/only} string with the best hypothesis. 
\end{DoxyReturn}


Definition at line 552 of file ngram\-\_\-search.\-c.



References bptbl\-\_\-s\-::bp, dict\-\_\-real\-\_\-word(), ps\-\_\-search\-\_\-s\-::hyp\-\_\-str, and bptbl\-\_\-s\-::wid.

\index{ngram\-\_\-search.\-c@{ngram\-\_\-search.\-c}!ngram\-\_\-search\-\_\-find\-\_\-exit@{ngram\-\_\-search\-\_\-find\-\_\-exit}}
\index{ngram\-\_\-search\-\_\-find\-\_\-exit@{ngram\-\_\-search\-\_\-find\-\_\-exit}!ngram_search.c@{ngram\-\_\-search.\-c}}
\subsubsection[{ngram\-\_\-search\-\_\-find\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}int ngram\-\_\-search\-\_\-find\-\_\-exit (
\begin{DoxyParamCaption}
\item[{{\bf ngram\-\_\-search\-\_\-t} $\ast$}]{ngs, }
\item[{int}]{frame\-\_\-idx, }
\item[{int32 $\ast$}]{out\-\_\-best\-\_\-score, }
\item[{int32 $\ast$}]{out\-\_\-is\-\_\-final}
\end{DoxyParamCaption}
)}\label{ngram__search_8c_ac6a01bb08e7b8d1deb39763a98148cb0}


Find the best word exit for the current frame in the backpointer table. 

\begin{DoxyReturn}{Returns}
the backpointer index of the best word exit. 
\end{DoxyReturn}


Definition at line 505 of file ngram\-\_\-search.\-c.



References B\-E\-T\-T\-E\-R\-\_\-\-T\-H\-A\-N, ngram\-\_\-search\-\_\-s\-::n\-\_\-frame, bptbl\-\_\-s\-::score, bptbl\-\_\-s\-::wid, and W\-O\-R\-S\-T\-\_\-\-S\-C\-O\-R\-E.

\index{ngram\-\_\-search.\-c@{ngram\-\_\-search.\-c}!ngram\-\_\-search\-\_\-mark\-\_\-bptable@{ngram\-\_\-search\-\_\-mark\-\_\-bptable}}
\index{ngram\-\_\-search\-\_\-mark\-\_\-bptable@{ngram\-\_\-search\-\_\-mark\-\_\-bptable}!ngram_search.c@{ngram\-\_\-search.\-c}}
\subsubsection[{ngram\-\_\-search\-\_\-mark\-\_\-bptable}]{\setlength{\rightskip}{0pt plus 5cm}int ngram\-\_\-search\-\_\-mark\-\_\-bptable (
\begin{DoxyParamCaption}
\item[{{\bf ngram\-\_\-search\-\_\-t} $\ast$}]{ngs, }
\item[{int}]{frame\-\_\-idx}
\end{DoxyParamCaption}
)}\label{ngram__search_8c_a7772e007b7d7fdf437c87aeb08b59c71}


Record the current frame's index in the backpointer table. 

\begin{DoxyReturn}{Returns}
the current backpointer index. 
\end{DoxyReturn}


Definition at line 328 of file ngram\-\_\-search.\-c.



References ngram\-\_\-search\-\_\-s\-::frm\-\_\-wordlist, and ngram\-\_\-search\-\_\-s\-::n\-\_\-frame\-\_\-alloc.



Referenced by ngram\-\_\-fwdflat\-\_\-finish(), ngram\-\_\-fwdflat\-\_\-search(), ngram\-\_\-fwdtree\-\_\-finish(), and ngram\-\_\-fwdtree\-\_\-search().

\index{ngram\-\_\-search.\-c@{ngram\-\_\-search.\-c}!ngram\-\_\-search\-\_\-set\-\_\-lm@{ngram\-\_\-search\-\_\-set\-\_\-lm}}
\index{ngram\-\_\-search\-\_\-set\-\_\-lm@{ngram\-\_\-search\-\_\-set\-\_\-lm}!ngram_search.c@{ngram\-\_\-search.\-c}}
\subsubsection[{ngram\-\_\-search\-\_\-set\-\_\-lm}]{\setlength{\rightskip}{0pt plus 5cm}void ngram\-\_\-search\-\_\-set\-\_\-lm (
\begin{DoxyParamCaption}
\item[{ngram\-\_\-model\-\_\-t $\ast$}]{lm}
\end{DoxyParamCaption}
)}\label{ngram__search_8c_a0e681022d3fa0e63da066aad123245e7}


Sets the global language model. 

Sets the language model to use if nothing was passed in configuration 

Definition at line 1406 of file ngram\-\_\-search.\-c.

